[
    {
        "id": "84f9df6667326f98",
        "type": "tab",
        "label": "Flow 1",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "c7d9c1b1f0a6a111",
        "type": "tab",
        "label": "\bChart from CSV",
        "disabled": false,
        "info": ""
    },
    {
        "id": "flow_all",
        "type": "tab",
        "label": "CSV Table & Download",
        "disabled": false,
        "info": ""
    },
    {
        "id": "tab_mjpg_sched",
        "type": "tab",
        "label": "MJPG Daily Restart",
        "disabled": false,
        "info": ""
    },
    {
        "id": "8e3d9986d6facbaa",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Only for test",
        "style": {
            "label": true
        },
        "nodes": [
            "7d94ba1bde198563",
            "352c9682952738a1",
            "2aac44c159923b07"
        ],
        "x": 34,
        "y": 2379,
        "w": 592,
        "h": 82
    },
    {
        "id": "db7c14177e93d281",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Weather",
        "style": {
            "label": true
        },
        "nodes": [
            "69a30e0444bb669f",
            "0c616ffe17850d92",
            "bf53ee007fe03cd5",
            "f5fd1707a82fa48e",
            "4cfd8f2b53cc451d",
            "293430283ab23a41",
            "b89586cab333bd2e",
            "c2ade38cad9171d1",
            "3d7d2f065fdf2586",
            "d586cb3f7734c89b",
            "86d402bb852608aa",
            "5d2cb7466e104cc6",
            "89e1ca49952cbc39",
            "38793410c1318250",
            "db41d8aaae19562a",
            "10e24fbb56540788",
            "54a303cc73b75606",
            "134c43948fc1ed53",
            "84304c396249d138",
            "5b23b8e421363f09",
            "a0a515737d2c4544"
        ],
        "x": 34,
        "y": 2479,
        "w": 1152,
        "h": 442
    },
    {
        "id": "5d6e724936f68d35",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Dist 1 Lighting",
        "style": {
            "label": true
        },
        "nodes": [
            "f4ae666054d7994e",
            "fa750acb8b93f284",
            "a0061edb8701d829",
            "4285be54b64d57c6",
            "6ff7a427dfeec829",
            "23dc3e6a516ae1c3",
            "4265400f21521fe3",
            "b502edc7e45ce251",
            "3ea78dedeaaf4c6f",
            "209c9e40e526fa6c",
            "ebec3f11f763b5eb",
            "a880f70db10cfa4e"
        ],
        "x": 64,
        "y": 1799,
        "w": 842,
        "h": 322
    },
    {
        "id": "17b6e50d0d55a4f0",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Get Temperature and Humidity data  by RS485 & Modbus",
        "style": {
            "label": true
        },
        "nodes": [
            "1ef22f386c9aec37",
            "3e0d3da6b07b2dc6",
            "27b42466e6ba6223",
            "218ff43bca981fe9",
            "44df4d9894a065c8",
            "b9d92e30fe8245b6",
            "6f78720a8e847149",
            "1f0406ae79e0ddfb",
            "edbaee0256ec938f",
            "9c2f5d5a308616e6",
            "8abaa57bae76a3db",
            "00d442aea9bc0def",
            "43781b4d61de441e",
            "9d04753ceb6008d4",
            "4eac55c97bf5ac4b",
            "d3d5c208297b5bcb",
            "ce91a081135d3653",
            "a81d2b73695ec428",
            "f033277dce8c9fc3"
        ],
        "x": 14,
        "y": -21,
        "w": 1032,
        "h": 582
    },
    {
        "id": "e74e46c298b7c6cb",
        "type": "group",
        "z": "flow_all",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "inject_10min",
            "uib_refresh",
            "tmpl_download",
            "table_read_file",
            "csv_to_json",
            "table_ui",
            "http_in_download",
            "read_file_download",
            "http_response_download",
            "eccd6ca216a8ac97",
            "734f54c626594136"
        ],
        "x": 34,
        "y": 19,
        "w": 972,
        "h": 342
    },
    {
        "id": "9b29f194d8a3aae8",
        "type": "group",
        "z": "flow_all",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "c6456d1672233c77",
            "9bb8aa797d2db538",
            "6fd08ead6c34727b",
            "888936cb5be63657",
            "7d38609966719e04",
            "ee81447397a9b21c",
            "d68f35126f715e09",
            "e3164829ad2f9c99",
            "d7ba64a61cb93a1c",
            "bd6f7ce9ccfb1bf7",
            "2205b965641cc936"
        ],
        "x": 14,
        "y": 399,
        "w": 1012,
        "h": 342
    },
    {
        "id": "466f7742a246e74a",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Air conditioning",
        "style": {
            "label": true
        },
        "nodes": [
            "bf3cffe8b8bf90c4",
            "e5c0943a8969389f",
            "4e27f9d174bd08fd",
            "a807676ee13f76fc",
            "7b17019d9694c425",
            "167efd5b81c44cdc",
            "3cba5f141191ab45",
            "249836baa17d7698",
            "43877a5160c9b295",
            "3e851f1eaea09d75",
            "4a9a0ff04207202d",
            "0834272c61fa1d91",
            "53e4c030b80e8a42",
            "1d50e0dd0e72e657",
            "893d48d19cc2c365"
        ],
        "x": 34,
        "y": 1379,
        "w": 1052,
        "h": 322
    },
    {
        "id": "912ed1b86333869f",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Dist 1 Nutrient solution input control",
        "style": {
            "label": true
        },
        "nodes": [
            "inp_a_ml",
            "fn_a_save_ml",
            "txt_a_current",
            "btn_a_run",
            "fn_a_run_ml",
            "gpio25_out",
            "txt_a_last",
            "file_a_csv",
            "inj_a_header",
            "fn_a_header_guard",
            "e10e368c452dd270",
            "2b753df6afdd64b6",
            "eaae89fb0638005f",
            "a87b84159b60d57f",
            "7284d4e9e0010867",
            "1a838d3ee158ae54",
            "6044e01bb19ae4bc",
            "6dddb568535969eb",
            "7715901eb0e673bd",
            "f97336f95369f779"
        ],
        "x": 34,
        "y": 2939,
        "w": 1132,
        "h": 462
    },
    {
        "id": "d0f7352041fbc952",
        "type": "group",
        "z": "flow_all",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "459214eb53b8201a",
            "f57f70b40106ba3b",
            "ae6fd6772d53e43a",
            "c1c5d1be217dd1ca",
            "74fee1ff15336b2e",
            "2923571850219960",
            "e9b78c33d6da39ab",
            "1d899e847958cc51",
            "762997c612a3239b",
            "d62e857fdfc39204",
            "64e0010d99179742"
        ],
        "x": 14,
        "y": 799,
        "w": 1042,
        "h": 342
    },
    {
        "id": "915bc3b1ca228f03",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Dist 1 Nutrient solution control",
        "style": {
            "label": true
        },
        "nodes": [
            "577253202c73b09c",
            "3725b711ea5e2772",
            "839c019b8d38b1ce",
            "2338e23a2b4a1061",
            "7164aeb31763ab09"
        ],
        "x": 34,
        "y": 2219,
        "w": 792,
        "h": 142
    },
    {
        "id": "e8ce93fc01bd7af9",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Get Solution condition (EC, pH, temp)  data by RS485 & Modbus",
        "style": {
            "label": true
        },
        "nodes": [
            "1753d4563875309b",
            "1aa3bbe8afdc012d",
            "7e26ce5601b49a9c",
            "27b92651c8adebe9",
            "13c6bea38d428920",
            "4a02d1b9cf1788c8",
            "a5e1c7bdeb69b644",
            "11865337c5295aac",
            "7af2caa5030f659e",
            "f66d5cc3cb3342a2",
            "bb98eb9ce85f5dcf",
            "b91f54bc77701ab9",
            "c8989cc1bcccdf49",
            "82f348c6dba2eac2",
            "5641f5451274dc21",
            "279ca9bacb60e6fc",
            "a04387180383435c",
            "9a4c7a02cad47b84",
            "b221c02018673863"
        ],
        "x": 24,
        "y": 579,
        "w": 1102,
        "h": 662
    },
    {
        "id": "3eaca329610704eb",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Get Solution condition (EC, pH, temp) data by RS485 & serial",
        "style": {
            "label": true
        },
        "nodes": [
            "1caf8a5c5e3446a5",
            "25a1fc18f884cf3a",
            "12a11f4918b20262",
            "ada6e5f91605f50b",
            "ded04047b201eda5",
            "3f103b9815f86dd4",
            "27c51267c346f89a",
            "882bd2a1db484c7a",
            "83ef16bf59648dba",
            "523fb7d4146c728e",
            "19575127be6263da",
            "7c25ba5dd16a36b6",
            "2c23a9c69bfd5964",
            "bed3ea5061f3aa42",
            "55c7596a34b371e7",
            "1b55bb39740ed3db",
            "10a137bf882b5184",
            "1236be8eabaf376f",
            "23d54e14bb05b234"
        ],
        "x": 1154,
        "y": 579,
        "w": 1112,
        "h": 662
    },
    {
        "id": "ad1743f076448914",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Dist 2 Lighting",
        "style": {
            "label": true
        },
        "nodes": [
            "661835450f15a6b4",
            "d785e496788ff69d",
            "32897822979abecd",
            "c98d03a0abbedcbd",
            "aa04375898a1948b",
            "d3ac968ba6e2864f",
            "9f360e5a54c95af6",
            "7a499e2de11fb75a",
            "e08d25bb4b05e048",
            "0b9b9d5aae2018ff",
            "ef29638c34485786",
            "a1e65c136a4faf8e"
        ],
        "x": 944,
        "y": 1839,
        "w": 842,
        "h": 322
    },
    {
        "id": "978a9587f7a84adc",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Dist 2 Nutrient solution control",
        "style": {
            "label": true
        },
        "nodes": [
            "4f385e73050961e1",
            "f15e7c328f5d7fd4",
            "63e650f897ae7cfe",
            "3aa9a7e96d4cfe09",
            "e320eb5d6e113614"
        ],
        "x": 914,
        "y": 2219,
        "w": 792,
        "h": 142
    },
    {
        "id": "b1927e4ba08d43c4",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Dist 2 Nutrient solution input control",
        "style": {
            "label": true
        },
        "nodes": [
            "032638cc6c5fc9f2",
            "742c215264b52d5d",
            "66ddab9642e34173",
            "e4a0abcae8745f5d",
            "80cc8c87a9dcdff5",
            "c7fe5d35e20589ec",
            "e0b97cfcaafbe7a8",
            "ce77e02c54e5281c",
            "d77f241745577d87",
            "f7516acac2b29596",
            "abf0f3cd0103cc31",
            "083acd90c241f25d",
            "972eec39af78be9a",
            "ada5f246a3285a35",
            "67dfe99f35a05924",
            "21fc1765b77482f9",
            "f37eddb8c684e4ec",
            "8bfc716cf46fb70d",
            "d4e056cc41c01da1",
            "78091ee38cd1e0cc"
        ],
        "x": 1254,
        "y": 2939,
        "w": 1132,
        "h": 462
    },
    {
        "id": "c62aa2d73263b188",
        "type": "group",
        "z": "flow_all",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "27fc66eaaca23794",
            "61caf0db18f2428d",
            "c09b25e4d365be34",
            "3f0ad1a72df8b757",
            "5a814c3c8a19e0be",
            "1ba33261f437d902",
            "36344a406840362d",
            "b2a258edcf5a958e",
            "9e97d9f96995bf28",
            "0be035f89455a795",
            "4d55c4ca6af1390e"
        ],
        "x": 1114,
        "y": 419,
        "w": 1012,
        "h": 342
    },
    {
        "id": "be44b588c52432ea",
        "type": "group",
        "z": "flow_all",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "e7891915e633acd2",
            "a6223c1af0cd3dd5",
            "8d665aadf1c7067c",
            "51704d967a421a19",
            "01e0b9d102a39fd5",
            "a3412107226a6d51",
            "9f1c418cd3f3a885",
            "94b0f12f3bc1db62",
            "7fd7452d9cd017ef",
            "370b70a08f5dc235",
            "a9ea43292fd0feba"
        ],
        "x": 1114,
        "y": 819,
        "w": 1042,
        "h": 342
    },
    {
        "id": "7e05584f07adae7b",
        "type": "group",
        "z": "c7d9c1b1f0a6a111",
        "name": "Dist 2 Solution state",
        "style": {
            "label": true
        },
        "nodes": [
            "f1b1e91b834b1e7b",
            "e6bfb513d88ab35f",
            "0fe32ae7f7830fa0",
            "84915ae7f5c9b3c6",
            "7b2f5b8520aa74d8",
            "6104d3b154bae62a",
            "10de8cbe4af04315",
            "66dddb17279fa4ea",
            "2ca82c801cc78dcf",
            "7bcaa443ae916920",
            "c17e5970c5cc707c"
        ],
        "x": 34,
        "y": 319,
        "w": 1412,
        "h": 222
    },
    {
        "id": "be6e98c17615581b",
        "type": "group",
        "z": "c7d9c1b1f0a6a111",
        "name": "Dist 1 Solution state",
        "style": {
            "label": true
        },
        "nodes": [
            "9a7f2b6b84f6a001",
            "6f1e2d3c4b5a6978",
            "f5a4c3b2d1e0f999",
            "2c1d3e4f5a6b7c80",
            "3d2e4f5a6b7c8d90",
            "4e3f5a6b7c8d9ea0",
            "3a6b1b2c3d4e5f60",
            "fc506592c792073d",
            "2b11787c0f4b97a0",
            "fcc61e3763443285",
            "9e58a61289d8c37b"
        ],
        "x": 34,
        "y": 39,
        "w": 1412,
        "h": 222
    },
    {
        "id": "89c2f9d79f818571",
        "type": "group",
        "z": "c7d9c1b1f0a6a111",
        "name": "Room condition",
        "style": {
            "label": true
        },
        "nodes": [
            "9d672b31c0fdbdf0",
            "11c49a6273f636d3",
            "a2f36fd67d9dfe31",
            "efb0d37433575254",
            "e7fd9e961e86b1b1",
            "74989654888b2172",
            "88a05da35409bfbf",
            "61d28f90c35a0e04",
            "c3284b9db2edcac0",
            "b4b069056ce7fe97"
        ],
        "x": 14,
        "y": 599,
        "w": 1372,
        "h": 202
    },
    {
        "id": "f8142c59ee10a26e",
        "type": "ui_base",
        "theme": {
            "name": "theme-dark",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "reset": false
            },
            "themeState": {
                "base-color": {
                    "default": "#097479",
                    "value": "#097479",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#111111",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#0eb8c0",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#555555",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#eeeeee",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#333333",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "CJA Skyfarms Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "YYY/MM/DD",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "a18fb94af755fd24",
        "type": "ui_tab",
        "name": "CJA Skyfarms Dashboard",
        "icon": "home",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "c888f82b8cc4653a",
        "type": "ui_group",
        "name": "Room Condition",
        "tab": "a18fb94af755fd24",
        "order": 1,
        "disp": true,
        "width": 18,
        "collapse": false,
        "className": ""
    },
    {
        "id": "049242d2ef9a58f0",
        "type": "ui_group",
        "name": "Humidity",
        "tab": "",
        "order": 2,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "c6a28c1ed72e1675",
        "type": "ui_group",
        "name": "Camera",
        "tab": "a18fb94af755fd24",
        "order": 5,
        "disp": false,
        "width": 7,
        "collapse": false,
        "className": ""
    },
    {
        "id": "1de49aac0f0db196",
        "type": "ui_group",
        "name": "Weather",
        "tab": "",
        "order": 8,
        "disp": true,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "ui_grp1",
        "type": "ui_group",
        "name": "Download",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "ui_tab_dashboard",
        "type": "ui_tab",
        "name": "Database",
        "icon": "file_download",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "ui_grp_table",
        "type": "ui_group",
        "name": "Room Condition Data",
        "tab": "ui_tab_dashboard",
        "order": 1,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "c5fb925fb5ca84e9",
        "type": "ui_group",
        "name": "Dist 1. Solution Condition",
        "tab": "a18fb94af755fd24",
        "order": 2,
        "disp": true,
        "width": 18,
        "collapse": false,
        "className": ""
    },
    {
        "id": "55294fa623e898e0",
        "type": "ui_group",
        "name": "pH",
        "tab": "",
        "order": 4,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "grp_dl",
        "type": "ui_group",
        "name": "Dist 1. Solution Data",
        "tab": "ui_tab_dashboard",
        "order": 2,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "ui_grp_ctrl",
        "type": "ui_group",
        "name": "Controls",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "0c96d57341bb54fa",
        "type": "ui_group",
        "name": "Dist 1. Solution Input Data",
        "tab": "ui_tab_dashboard",
        "order": 3,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "9a12b08656165df4",
        "type": "ui_group",
        "name": "Solution Temperature",
        "tab": "",
        "order": 5,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "4ea62e075d022552",
        "type": "ui_group",
        "name": "CO2",
        "tab": "",
        "order": 10,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "aa578847983587e6",
        "type": "ui_group",
        "name": "Dist 2. Solution Condition",
        "tab": "a18fb94af755fd24",
        "order": 3,
        "disp": true,
        "width": 18,
        "collapse": false,
        "className": ""
    },
    {
        "id": "f870e65464d4e015",
        "type": "ui_spacer",
        "z": "84f9df6667326f98",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 7,
        "height": 1
    },
    {
        "id": "db6402d6f3215edd",
        "type": "ui_spacer",
        "z": "84f9df6667326f98",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 7,
        "height": 1
    },
    {
        "id": "8e06d2030eb18082",
        "type": "ui_tab",
        "name": "Controller",
        "icon": "\bphone",
        "order": 2,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "e3eac795c3a63651",
        "type": "ui_group",
        "name": "Dist 2. Controller",
        "tab": "8e06d2030eb18082",
        "order": 3,
        "disp": true,
        "width": 8,
        "collapse": false,
        "className": ""
    },
    {
        "id": "78ac3218e47134df",
        "type": "ui_group",
        "name": "Dist 2. Inject Soluition A, B and Acid",
        "tab": "8e06d2030eb18082",
        "order": 4,
        "disp": true,
        "width": 8,
        "collapse": false,
        "className": ""
    },
    {
        "id": "e01a3e2ceb3f788b",
        "type": "ui_spacer",
        "z": "84f9df6667326f98",
        "name": "spacer",
        "group": "e3eac795c3a63651",
        "order": 5,
        "width": 4,
        "height": 1
    },
    {
        "id": "88aa0f01fff00cbe",
        "type": "ui_spacer",
        "z": "84f9df6667326f98",
        "name": "spacer",
        "group": "e3eac795c3a63651",
        "order": 8,
        "width": 4,
        "height": 1
    },
    {
        "id": "96111742475c44e1",
        "type": "ui_group",
        "name": "Dist 2. Solution data",
        "tab": "ui_tab_dashboard",
        "order": 4,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "1b4aaf5eb31383f2",
        "type": "ui_group",
        "name": "Dist 2. Solution Input Data",
        "tab": "ui_tab_dashboard",
        "order": 5,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "f325796ebb721579",
        "type": "ui_group",
        "name": "Dist 1. Controller",
        "tab": "8e06d2030eb18082",
        "order": 1,
        "disp": true,
        "width": 8,
        "collapse": false,
        "className": ""
    },
    {
        "id": "grp_a_pump",
        "type": "ui_group",
        "name": "Dist 1. Inject Solution A, B and Acid",
        "tab": "8e06d2030eb18082",
        "order": 2,
        "disp": true,
        "width": 8,
        "collapse": false,
        "className": ""
    },
    {
        "id": "b2e3d4c5f6a7b890",
        "type": "ui_group",
        "name": "Dist 1 (Last 7 days)",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": "18",
        "collapse": false
    },
    {
        "id": "chart_group",
        "type": "ui_group",
        "name": "Room Condition (CSV)",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": 12
    },
    {
        "id": "754652e575651e31",
        "type": "remote-config",
        "name": "CJA Skyfarms Dashboard",
        "host": "192.168.5.145",
        "protocol": "https",
        "port": "1880",
        "baseurl": "/ui",
        "instancehash": "c60xrzt1sywo8yr5osssyrkf0yo9sr1vi9gval2usgptvzwc8xbbpxgfiitimpxt",
        "server": "nodered05.remote-red.com",
        "region": "sg"
    },
    {
        "id": "bbb354e7c724e7d9",
        "type": "remote-config",
        "name": "Node-RED UI",
        "host": "localhost",
        "protocol": "https",
        "port": "1880",
        "baseurl": "/ui",
        "instancehash": "g9u7xzwtmi6h7dp18uvckhwu6hkknujcv517oyyijq95gnneuezbckm2locnb0ie",
        "server": "nodered05.remote-red.com",
        "region": "sg"
    },
    {
        "id": "1ef22f386c9aec37",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 100,
        "wires": [
            [
                "3e0d3da6b07b2dc6"
            ]
        ]
    },
    {
        "id": "3e0d3da6b07b2dc6",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "Room_condition",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/sensors/room_condition.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 320,
        "y": 100,
        "wires": [
            [
                "27b42466e6ba6223"
            ]
        ]
    },
    {
        "id": "27b42466e6ba6223",
        "type": "json",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 510,
        "y": 100,
        "wires": [
            [
                "218ff43bca981fe9",
                "44df4d9894a065c8",
                "b9d92e30fe8245b6",
                "d3d5c208297b5bcb",
                "9c2f5d5a308616e6"
            ]
        ]
    },
    {
        "id": "218ff43bca981fe9",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "17b6e50d0d55a4f0",
        "name": "Date str",
        "rules": [
            {
                "t": "move",
                "p": "payload.date",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 100,
        "wires": [
            [
                "edbaee0256ec938f"
            ]
        ]
    },
    {
        "id": "44df4d9894a065c8",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "Temperature",
        "rules": [
            {
                "t": "move",
                "p": "payload.temperature",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 160,
        "wires": [
            [
                "6f78720a8e847149",
                "8abaa57bae76a3db",
                "43781b4d61de441e"
            ]
        ]
    },
    {
        "id": "b9d92e30fe8245b6",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "Humidity",
        "rules": [
            {
                "t": "move",
                "p": "payload.humidity",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 300,
        "wires": [
            [
                "1f0406ae79e0ddfb",
                "00d442aea9bc0def",
                "9d04753ceb6008d4"
            ]
        ]
    },
    {
        "id": "6f78720a8e847149",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "debug 2",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 900,
        "y": 160,
        "wires": []
    },
    {
        "id": "1f0406ae79e0ddfb",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "debug 3",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 920,
        "y": 320,
        "wires": []
    },
    {
        "id": "edbaee0256ec938f",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "17b6e50d0d55a4f0",
        "name": "Date str to date",
        "func": "// Get the input string from msg.payload\nlet valueString = msg.payload;  // e.g., \"2025-06-17 18:13\"\n\n// Replace space with 'T' to ensure proper ISO 8601 format\nlet isoFormat = valueString.replace(\" \", \"T\");\n\n// Convert the string to a JavaScript Date object\nlet dateObj = new Date(isoFormat);\nmsg.payload = dateObj\n\n// Check if the date is valid\n//if (isNaN(dateObj.getTime())) {\n//    msg.payload = { error: \"Invalid date format\" };\n//} else {\n//    msg.payload = {\n//        original: valueString,\n//        date: dateObj\n//    };\n//}\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 880,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "9c2f5d5a308616e6",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "debug 1",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 740,
        "y": 20,
        "wires": []
    },
    {
        "id": "8abaa57bae76a3db",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "",
        "group": "c888f82b8cc4653a",
        "order": 1,
        "width": 6,
        "height": 5,
        "gtype": "gage",
        "title": "Temperature",
        "label": "â„ƒ",
        "format": "{{value}}",
        "min": "10",
        "max": "40",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "23",
        "seg2": "30",
        "diff": false,
        "className": "",
        "x": 930,
        "y": 220,
        "wires": []
    },
    {
        "id": "7d94ba1bde198563",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "8e3d9986d6facbaa",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "10",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 2420,
        "wires": [
            [
                "2aac44c159923b07"
            ]
        ]
    },
    {
        "id": "352c9682952738a1",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "8e3d9986d6facbaa",
        "name": "debug 4",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 520,
        "y": 2420,
        "wires": []
    },
    {
        "id": "2aac44c159923b07",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "8e3d9986d6facbaa",
        "name": "Relay_test",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/test_code/relay_test.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 330,
        "y": 2420,
        "wires": [
            [
                "352c9682952738a1"
            ]
        ]
    },
    {
        "id": "00d442aea9bc0def",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "",
        "group": "c888f82b8cc4653a",
        "order": 2,
        "width": 6,
        "height": 5,
        "gtype": "wave",
        "title": "Humidity",
        "label": "%",
        "format": "{{value}}",
        "min": "30",
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "diff": false,
        "className": "",
        "x": 920,
        "y": 360,
        "wires": []
    },
    {
        "id": "43781b4d61de441e",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "17b6e50d0d55a4f0",
        "name": "",
        "group": "",
        "order": 22,
        "width": 6,
        "height": 5,
        "label": "Temperature",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "10",
        "ymax": "40",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 930,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "9d04753ceb6008d4",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "17b6e50d0d55a4f0",
        "name": "",
        "group": "",
        "order": 23,
        "width": 6,
        "height": 5,
        "label": "Humidity",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "20",
        "ymax": "100",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 920,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "4eac55c97bf5ac4b",
        "type": "comment",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "Read temp, humi data and show on the dashboard",
        "info": "",
        "x": 230,
        "y": 60,
        "wires": []
    },
    {
        "id": "3e851f1eaea09d75",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "",
        "label": "Mini Fan",
        "tooltip": "",
        "group": "f325796ebb721579",
        "order": 5,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "Node-Red Dashboard Custom CSS",
        "x": 340,
        "y": 1440,
        "wires": [
            [
                "1d50e0dd0e72e657",
                "893d48d19cc2c365"
            ]
        ]
    },
    {
        "id": "167efd5b81c44cdc",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "group": "f325796ebb721579",
        "order": 4,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "Air conditioning",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "style": true,
        "font": "Arial,Arial,Helvetica,sans-serif",
        "fontSize": "25",
        "color": "#ffffff",
        "x": 140,
        "y": 1480,
        "wires": []
    },
    {
        "id": "43877a5160c9b295",
        "type": "rpi-gpio out",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "GPIO: 13",
        "pin": "13",
        "set": true,
        "level": "1",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 960,
        "y": 1500,
        "wires": []
    },
    {
        "id": "3cba5f141191ab45",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "",
        "label": "Circulator",
        "tooltip": "",
        "group": "f325796ebb721579",
        "order": 7,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 340,
        "y": 1560,
        "wires": [
            [
                "a807676ee13f76fc",
                "4e27f9d174bd08fd"
            ]
        ]
    },
    {
        "id": "249836baa17d7698",
        "type": "rpi-gpio out",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "GPIO: 16",
        "pin": "16",
        "set": true,
        "level": "1",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 940,
        "y": 1640,
        "wires": []
    },
    {
        "id": "69a30e0444bb669f",
        "type": "inject",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "60",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 150,
        "y": 2600,
        "wires": [
            [
                "0c616ffe17850d92"
            ]
        ]
    },
    {
        "id": "0c616ffe17850d92",
        "type": "http request",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "openweather data request",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "https://api.openweathermap.org/data/2.5/weather?id=1837055&appid=879d48a29fd4ed55df4a26799ecd2344",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 350,
        "y": 2600,
        "wires": [
            [
                "bf53ee007fe03cd5",
                "f5fd1707a82fa48e"
            ]
        ]
    },
    {
        "id": "bf53ee007fe03cd5",
        "type": "debug",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "msg.payload",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 510,
        "y": 2520,
        "wires": []
    },
    {
        "id": "f5fd1707a82fa48e",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "Weather data parsing",
        "func": "// Convert Kelvin to Celsius\nfunction toCelsius(kelvin) {\n    return parseFloat((kelvin - 273.15).toFixed(2));\n}\n\n// Convert wind degrees to 8-point compass direction\nfunction windDirection8(deg) {\n    const dirs = [\"N\", \"NE\", \"E\", \"NE\", \"N\", \"NW\", \"W\", \"NW\"];\n    return dirs[Math.round(deg / 45) % 8];\n}\n\n// Get rain info\nlet rainAmount = 0;\nif (msg.payload.rain && msg.payload.rain[\"1h\"]) {\n    rainAmount = msg.payload.rain[\"1h\"];\n}\n\n// Get probability of precipitation\nlet pop = msg.payload.pop !== undefined ? Math.round(msg.payload.pop * 100) : (rainAmount > 0 ? 100 : 0);\n\n// Format timestamp\nlet time = new Date(msg.payload.dt * 1000).toLocaleString('en-KR');\n\n// Extract and convert values\nlet temp = toCelsius(msg.payload.main.temp);\nlet feels_like = toCelsius(msg.payload.main.feels_like);\nlet humidity = msg.payload.main.humidity;\nlet wind_speed = parseFloat(msg.payload.wind.speed.toFixed(2));\nlet wind_deg = msg.payload.wind.deg;\nlet wind_dir = windDirection8(wind_deg);\n\nmsg.payload = {\n    time: time,\n    temp: temp,\n    feels_like: feels_like,\n    humidity: humidity,\n    wind_speed: wind_speed,\n    wind_deg: wind_deg,\n    wind_direction: wind_dir,\n    rain_mm_per_hour: rainAmount,\n    pop_percent: pop\n};\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 2600,
        "wires": [
            [
                "4cfd8f2b53cc451d",
                "293430283ab23a41",
                "b89586cab333bd2e",
                "c2ade38cad9171d1",
                "3d7d2f065fdf2586",
                "d586cb3f7734c89b",
                "86d402bb852608aa",
                "5d2cb7466e104cc6",
                "89e1ca49952cbc39"
            ]
        ]
    },
    {
        "id": "4cfd8f2b53cc451d",
        "type": "debug",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "msg.payload",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 730,
        "y": 2520,
        "wires": []
    },
    {
        "id": "293430283ab23a41",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "Temperature_out",
        "rules": [
            {
                "t": "move",
                "p": "payload.temp",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 830,
        "y": 2640,
        "wires": [
            [
                "134c43948fc1ed53"
            ]
        ]
    },
    {
        "id": "b89586cab333bd2e",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "Feel_temp_out",
        "rules": [
            {
                "t": "move",
                "p": "payload.feels_like",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 820,
        "y": 2680,
        "wires": [
            [
                "db41d8aaae19562a"
            ]
        ]
    },
    {
        "id": "c2ade38cad9171d1",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "Humi_out",
        "rules": [
            {
                "t": "move",
                "p": "payload.humidity",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 800,
        "y": 2720,
        "wires": [
            [
                "10e24fbb56540788"
            ]
        ]
    },
    {
        "id": "3d7d2f065fdf2586",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "wind_out",
        "rules": [
            {
                "t": "move",
                "p": "payload.wind_speed",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 800,
        "y": 2760,
        "wires": [
            [
                "54a303cc73b75606"
            ]
        ]
    },
    {
        "id": "d586cb3f7734c89b",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "wind_dirct_out",
        "rules": [
            {
                "t": "move",
                "p": "payload.wind_direction",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 820,
        "y": 2800,
        "wires": [
            [
                "84304c396249d138"
            ]
        ]
    },
    {
        "id": "86d402bb852608aa",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "precipitation_out",
        "rules": [
            {
                "t": "move",
                "p": "payload.rain_mm_per_hour",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 820,
        "y": 2880,
        "wires": [
            [
                "a0a515737d2c4544"
            ]
        ]
    },
    {
        "id": "5d2cb7466e104cc6",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "precipitation_per_out",
        "rules": [
            {
                "t": "move",
                "p": "payload.pop_percent",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 840,
        "y": 2840,
        "wires": [
            [
                "5b23b8e421363f09"
            ]
        ]
    },
    {
        "id": "89e1ca49952cbc39",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "date",
        "rules": [
            {
                "t": "move",
                "p": "payload.time",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 790,
        "y": 2600,
        "wires": [
            [
                "38793410c1318250"
            ]
        ]
    },
    {
        "id": "38793410c1318250",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "group": "1de49aac0f0db196",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "style": true,
        "font": "",
        "fontSize": "20",
        "color": "#ffffff",
        "x": 1030,
        "y": 2600,
        "wires": []
    },
    {
        "id": "db41d8aaae19562a",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "group": "1de49aac0f0db196",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Feel Like",
        "format": "{{msg.payload}} â„ƒ",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "",
        "fontSize": "20",
        "color": "#ffffff",
        "x": 1040,
        "y": 2680,
        "wires": []
    },
    {
        "id": "10e24fbb56540788",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "group": "1de49aac0f0db196",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Humidity",
        "format": "{{msg.payload}} %",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "",
        "fontSize": "20",
        "color": "#ffffff",
        "x": 1040,
        "y": 2720,
        "wires": []
    },
    {
        "id": "54a303cc73b75606",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "group": "1de49aac0f0db196",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Wind Speed",
        "format": "{{msg.payload}} m/s",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "",
        "fontSize": "20",
        "color": "#ffffff",
        "x": 1050,
        "y": 2760,
        "wires": []
    },
    {
        "id": "134c43948fc1ed53",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "group": "1de49aac0f0db196",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Air Temperature",
        "format": "{{msg.payload}} â„ƒ",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "",
        "fontSize": "20",
        "color": "#ffffff",
        "x": 1060,
        "y": 2640,
        "wires": []
    },
    {
        "id": "84304c396249d138",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "group": "1de49aac0f0db196",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Wind Direction",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "",
        "fontSize": "20",
        "color": "#ffffff",
        "x": 1060,
        "y": 2800,
        "wires": []
    },
    {
        "id": "5b23b8e421363f09",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "group": "1de49aac0f0db196",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Rainfall Probablility",
        "format": "{{msg.payload}} %",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "",
        "fontSize": "20",
        "color": "#ffffff",
        "x": 1070,
        "y": 2840,
        "wires": []
    },
    {
        "id": "a0a515737d2c4544",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "group": "1de49aac0f0db196",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Rainfall",
        "format": "{{msg.payload}} mm/h",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "",
        "fontSize": "20",
        "color": "#ffffff",
        "x": 1040,
        "y": 2880,
        "wires": []
    },
    {
        "id": "31b42f4d9be9eb00",
        "type": "ui_template",
        "z": "84f9df6667326f98",
        "group": "c6a28c1ed72e1675",
        "name": "Streaming the mjpg",
        "order": 1,
        "width": 7,
        "height": 6,
        "format": "<div style=\"text-align: center;\">\n    <h3>Live Stream (Preview)</h3>\n\n    <!-- ì¶•ì†Œëœ í™”ë©´ í¬ê¸°ì— ë§žì¶° ë¶€ëª¨ div ë†’ì´ë„ ì¡°ì • -->\n    <div style=\"width: 320px; height: 180px; overflow: hidden; display: inline-block;\">\n        <div style=\"transform: scale(0.25); transform-origin: top left;\">\n            <iframe src=\"http://1.217.132.157:8080/?action=stream\" width=\"1280\" height=\"720\" frameborder=\"0\"\n                style=\"border:1px solid #ccc;\">\n            </iframe>\n        </div>\n    </div>\n\n    <!-- ì „ì²´í™”ë©´ ë²„íŠ¼ - ì˜ìƒ ë°”ë¡œ ë°‘ì— ìœ„ì¹˜ -->\n    <div style=\"margin-top: 6px;\">\n        <a href=\"http://1.217.132.157:8080/?action=stream\" target=\"_blank\">\n            <button style=\"padding: 6px 12px;\">Full screen</button>\n        </a>\n    </div>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 130,
        "y": 1280,
        "wires": [
            []
        ]
    },
    {
        "id": "13c6bea38d428920",
        "type": "json",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 470,
        "y": 680,
        "wires": [
            [
                "4a02d1b9cf1788c8",
                "a5e1c7bdeb69b644",
                "11865337c5295aac",
                "a04387180383435c",
                "1753d4563875309b"
            ]
        ]
    },
    {
        "id": "4a02d1b9cf1788c8",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "e8ce93fc01bd7af9",
        "name": "Date str",
        "rules": [
            {
                "t": "move",
                "p": "payload.date",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 660,
        "y": 680,
        "wires": [
            [
                "bb98eb9ce85f5dcf"
            ]
        ]
    },
    {
        "id": "a5e1c7bdeb69b644",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "EC",
        "rules": [
            {
                "t": "move",
                "p": "payload.EC",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 650,
        "y": 740,
        "wires": [
            [
                "7af2caa5030f659e",
                "c8989cc1bcccdf49",
                "5641f5451274dc21"
            ]
        ]
    },
    {
        "id": "11865337c5295aac",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "pH",
        "rules": [
            {
                "t": "move",
                "p": "payload.pH",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 650,
        "y": 940,
        "wires": [
            [
                "f66d5cc3cb3342a2",
                "82f348c6dba2eac2",
                "279ca9bacb60e6fc"
            ]
        ]
    },
    {
        "id": "7af2caa5030f659e",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "Dist 1 EC",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 860,
        "y": 740,
        "wires": []
    },
    {
        "id": "f66d5cc3cb3342a2",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "Dist 1 pH",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 860,
        "y": 940,
        "wires": []
    },
    {
        "id": "bb98eb9ce85f5dcf",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "e8ce93fc01bd7af9",
        "name": "Date str to date",
        "func": "// Get the input string from msg.payload\nlet valueString = msg.payload;  // e.g., \"2025-06-17 18:13\"\n\n// Replace space with 'T' to ensure proper ISO 8601 format\nlet isoFormat = valueString.replace(\" \", \"T\");\n\n// Convert the string to a JavaScript Date object\nlet dateObj = new Date(isoFormat);\nmsg.payload = dateObj\n\n// Check if the date is valid\n//if (isNaN(dateObj.getTime())) {\n//    msg.payload = { error: \"Invalid date format\" };\n//} else {\n//    msg.payload = {\n//        original: valueString,\n//        date: dateObj\n//    };\n//}\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 840,
        "y": 680,
        "wires": [
            [
                "b91f54bc77701ab9"
            ]
        ]
    },
    {
        "id": "b91f54bc77701ab9",
        "type": "debug",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "e8ce93fc01bd7af9",
        "name": "debug 8",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1020,
        "y": 680,
        "wires": []
    },
    {
        "id": "c8989cc1bcccdf49",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "",
        "group": "c5fb925fb5ca84e9",
        "order": 1,
        "width": 6,
        "height": 5,
        "gtype": "gage",
        "title": "EC",
        "label": "mS/cm",
        "format": "{{value}}",
        "min": "0",
        "max": "3",
        "colors": [
            "#00b500",
            "#00b500",
            "#b50000"
        ],
        "seg1": "",
        "seg2": "1.8",
        "diff": false,
        "className": "",
        "x": 870,
        "y": 800,
        "wires": []
    },
    {
        "id": "82f348c6dba2eac2",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "",
        "group": "c5fb925fb5ca84e9",
        "order": 2,
        "width": 6,
        "height": 5,
        "gtype": "gage",
        "title": "pH",
        "label": "",
        "format": "{{value}}",
        "min": "0",
        "max": "10",
        "colors": [
            "#b50000",
            "#00b500",
            "#b50000"
        ],
        "seg1": "5.5",
        "seg2": "7",
        "diff": false,
        "className": "",
        "x": 870,
        "y": 1000,
        "wires": []
    },
    {
        "id": "5641f5451274dc21",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "e8ce93fc01bd7af9",
        "name": "",
        "group": "",
        "order": 22,
        "width": 6,
        "height": 5,
        "label": "EC",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "3",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 870,
        "y": 860,
        "wires": [
            []
        ]
    },
    {
        "id": "279ca9bacb60e6fc",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "e8ce93fc01bd7af9",
        "name": "",
        "group": "",
        "order": 7,
        "width": 6,
        "height": 5,
        "label": "pH",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "10",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 870,
        "y": 1040,
        "wires": [
            []
        ]
    },
    {
        "id": "f4ae666054d7994e",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "5d6e724936f68d35",
        "name": "UV Automation",
        "label": "UV Automation",
        "tooltip": "",
        "group": "",
        "order": 4,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "topicType": "str",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 180,
        "y": 2000,
        "wires": [
            [
                "a0061edb8701d829",
                "23dc3e6a516ae1c3"
            ]
        ]
    },
    {
        "id": "fa750acb8b93f284",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "5d6e724936f68d35",
        "group": "",
        "order": 5,
        "width": 3,
        "height": 1,
        "name": "UV Status",
        "label": "UV Status",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 770,
        "y": 2000,
        "wires": []
    },
    {
        "id": "a0061edb8701d829",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "5d6e724936f68d35",
        "name": "flow.enable ì €ìž¥",
        "func": "flow.set('uv_enable', msg.payload === true);\nreturn null;",
        "outputs": 0,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 1980,
        "wires": []
    },
    {
        "id": "4285be54b64d57c6",
        "type": "inject",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "5d6e724936f68d35",
        "name": "ë§¤ 10ë¶„ë§ˆë‹¤ ì‹¤í–‰",
        "props": [],
        "repeat": "600",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "x": 190,
        "y": 2080,
        "wires": [
            [
                "6ff7a427dfeec829"
            ]
        ]
    },
    {
        "id": "6ff7a427dfeec829",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "5d6e724936f68d35",
        "name": "ìŠ¤ì¼€ì¤„ ONì¼ ë•Œë§Œ 1/0 ê²°ì • + ìƒíƒœë¬¸êµ¬",
        "func": "if (flow.get('uv_enable') !== true) return null;\nconst now = new Date();\nconst hour = now.getHours(); \nconst minutes = now.getMinutes();\nlet val = 1;               // ê¸°ë³¸ OFF(1)\nlet text = 'OFF';\nif (hour >= 1 && hour < 13) { val = 0; text = 'ON'; }\n// if (minutes >= 25 && minutes < 26) { val = 0; text = 'ON'; }\n// ì¶œë ¥1: GPIO, ì¶œë ¥2: ìƒíƒœë¬¸êµ¬\nreturn [ {payload: val}, {payload: text} ];\n\n// if (flow.get('uv_enable') !== true) return null;\n// í˜„ìž¬ ì‹œê°„(hour) ê°€ì ¸ì˜¤ê¸°\n// let now = new Date();\n// let hour = now.getHours();\n// let minutes = now.getMinutes();\n// let pinState = 1;              // ê¸°ë³¸ OFF(1)\n// let text = 'OFF';\n\n\n// // 00ì‹œ ~ 06ì‹œ ì‚¬ì´ ON (0)\n// // if (hour >= 0 && hour < 6) {\n// if (minutes >= 22 && minutes < 23) {\n//     pinState = 0; // ON\n// } else {\n//     pinState = 1; // OFF\n// }\n\n// msg.payload = pinState;\n// return msg;",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 490,
        "y": 2080,
        "wires": [
            [
                "4265400f21521fe3"
            ],
            [
                "fa750acb8b93f284"
            ]
        ]
    },
    {
        "id": "23dc3e6a516ae1c3",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "5d6e724936f68d35",
        "name": "ìŠ¤ìœ„ì¹˜ í† ê¸€ ì‹œ í˜„ìž¬ìƒíƒœ ìž¬í‘œì‹œ",
        "func": "const enabled = (msg.payload === true);\nif (!enabled) { return [{}, {payload:'OFF'}]; }\nconst now = new Date();\nconst hour = now.getHours();\nconst minutes = now.getMinutes();\nconst text = (hour >= 1 && hour < 3) ? 'ON' : 'OFF';\n// const text = (minutes >= 25 && minutes < 26) ? 'ON' : 'OFF';\nreturn [ {payload: Date.now()}, {payload: text} ];",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 480,
        "y": 2020,
        "wires": [
            [
                "6ff7a427dfeec829"
            ],
            [
                "fa750acb8b93f284"
            ]
        ]
    },
    {
        "id": "4265400f21521fe3",
        "type": "rpi-gpio out",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "5d6e724936f68d35",
        "name": "GPIO18 (pin 12)",
        "pin": "18",
        "set": true,
        "level": "1",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 800,
        "y": 2080,
        "wires": []
    },
    {
        "id": "b502edc7e45ce251",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "5d6e724936f68d35",
        "name": "Dist_1_LED controller",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/Dist_1_LEDController.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 540,
        "y": 1900,
        "wires": [
            [
                "209c9e40e526fa6c"
            ]
        ]
    },
    {
        "id": "3ea78dedeaaf4c6f",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "5d6e724936f68d35",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 300,
        "y": 1900,
        "wires": [
            [
                "b502edc7e45ce251"
            ]
        ]
    },
    {
        "id": "209c9e40e526fa6c",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "5d6e724936f68d35",
        "name": "debug 5",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 720,
        "y": 1900,
        "wires": []
    },
    {
        "id": "ebec3f11f763b5eb",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "g": "5d6e724936f68d35",
        "name": "",
        "label": "LED",
        "tooltip": "",
        "group": "f325796ebb721579",
        "order": 2,
        "width": 4,
        "height": 1,
        "passthru": false,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "false",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "true",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 150,
        "y": 1900,
        "wires": [
            [
                "3ea78dedeaaf4c6f"
            ]
        ]
    },
    {
        "id": "a880f70db10cfa4e",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "5d6e724936f68d35",
        "group": "f325796ebb721579",
        "order": 1,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "Lighting",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "style": true,
        "font": "Arial,Arial,Helvetica,sans-serif",
        "fontSize": "25",
        "color": "#ffffff",
        "x": 160,
        "y": 1840,
        "wires": []
    },
    {
        "id": "a04387180383435c",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "debug 9",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 620,
        "y": 620,
        "wires": []
    },
    {
        "id": "0834272c61fa1d91",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "ìŠ¤ì¼€ì¤„ ONì¼ ë•Œë§Œ 1/0 ê²°ì • + ìƒíƒœë¬¸êµ¬",
        "func": "if (flow.get('miniFan_enable') !== true) return null;\nconst now = new Date();\nconst hour = now.getHours(); \nconst minutes = now.getMinutes();\nlet val = 1;               // ê¸°ë³¸ OFF(1)\nlet text = 'OFF';\nif (hour >= 5 && hour < 23) { val = 0; text = 'ON'; }\n// if (minutes >= 46 && minutes < 47) { val = 0; text = 'ON'; }\n// ì¶œë ¥1: GPIO, ì¶œë ¥2: ìƒíƒœë¬¸êµ¬\nreturn [ {payload: val}, {payload: text} ];\n\n// if (flow.get('uv_enable') !== true) return null;\n// í˜„ìž¬ ì‹œê°„(hour) ê°€ì ¸ì˜¤ê¸°\n// let now = new Date();\n// let hour = now.getHours();\n// let minutes = now.getMinutes();\n// let pinState = 1;              // ê¸°ë³¸ OFF(1)\n// let text = 'OFF';\n\n\n// // 00ì‹œ ~ 06ì‹œ ì‚¬ì´ ON (0)\n// // if (hour >= 0 && hour < 6) {\n// if (minutes >= 22 && minutes < 23) {\n//     pinState = 0; // ON\n// } else {\n//     pinState = 1; // OFF\n// }\n\n// msg.payload = pinState;\n// return msg;",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 670,
        "y": 1520,
        "wires": [
            [
                "43877a5160c9b295"
            ],
            [
                "53e4c030b80e8a42"
            ]
        ]
    },
    {
        "id": "53e4c030b80e8a42",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "group": "f325796ebb721579",
        "order": 6,
        "width": 4,
        "height": 1,
        "name": "Mini Fan Status",
        "label": "Mini Fan Status",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 970,
        "y": 1440,
        "wires": []
    },
    {
        "id": "1d50e0dd0e72e657",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "ìŠ¤ìœ„ì¹˜ í† ê¸€ ì‹œ í˜„ìž¬ìƒíƒœ ìž¬í‘œì‹œ",
        "func": "const enabled = (msg.payload === true);\nif (!enabled) { return [{}, {payload:'OFF'}]; }\nconst now = new Date();\nconst hour = now.getHours();\nconst minutes = now.getMinutes();\nconst text = (hour >= 5 && hour < 23) ? 'OFF' : 'ON';\n// const text = (minutes >= 46 && minutes < 47) ? 'ON' : 'OFF';\nreturn [ {payload: Date.now()}, {payload: text} ];",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 660,
        "y": 1460,
        "wires": [
            [
                "0834272c61fa1d91"
            ],
            [
                "53e4c030b80e8a42"
            ]
        ]
    },
    {
        "id": "893d48d19cc2c365",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "flow.enable ì €ìž¥",
        "func": "flow.set('miniFan_enable', msg.payload === true);\nreturn null;",
        "outputs": 0,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 610,
        "y": 1420,
        "wires": []
    },
    {
        "id": "4a9a0ff04207202d",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "ë§¤ 5ì´ˆë§ˆë‹¤ ì‹¤í–‰",
        "props": [],
        "repeat": "5",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "x": 360,
        "y": 1520,
        "wires": [
            [
                "0834272c61fa1d91"
            ]
        ]
    },
    {
        "id": "bf3cffe8b8bf90c4",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "ë§¤ 5ì´ˆë§ˆë‹¤ ì‹¤í–‰",
        "props": [],
        "repeat": "5",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "x": 360,
        "y": 1660,
        "wires": [
            [
                "e5c0943a8969389f"
            ]
        ]
    },
    {
        "id": "e5c0943a8969389f",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "ìŠ¤ì¼€ì¤„ ONì¼ ë•Œë§Œ 1/0 ê²°ì • + ìƒíƒœë¬¸êµ¬",
        "func": "if (flow.get('circulator_enable') !== true) return null;\nconst now = new Date();\nconst hour = now.getHours(); \nconst minutes = now.getMinutes();\nlet val = 1;               // ê¸°ë³¸ OFF(1)\nlet text = 'OFF';\nif (hour >= 5 && hour < 23) { val = 0; text = 'ON'; }\n// if (minutes >= 25 && minutes < 26) { val = 0; text = 'ON'; }\n// ì¶œë ¥1: GPIO, ì¶œë ¥2: ìƒíƒœë¬¸êµ¬\nreturn [ {payload: val}, {payload: text} ];\n\n// if (flow.get('uv_enable') !== true) return null;\n// í˜„ìž¬ ì‹œê°„(hour) ê°€ì ¸ì˜¤ê¸°\n// let now = new Date();\n// let hour = now.getHours();\n// let minutes = now.getMinutes();\n// let pinState = 1;              // ê¸°ë³¸ OFF(1)\n// let text = 'OFF';\n\n\n// // 00ì‹œ ~ 06ì‹œ ì‚¬ì´ ON (0)\n// // if (hour >= 0 && hour < 6) {\n// if (minutes >= 22 && minutes < 23) {\n//     pinState = 0; // ON\n// } else {\n//     pinState = 1; // OFF\n// }\n\n// msg.payload = pinState;\n// return msg;",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 670,
        "y": 1660,
        "wires": [
            [
                "249836baa17d7698"
            ],
            [
                "7b17019d9694c425"
            ]
        ]
    },
    {
        "id": "4e27f9d174bd08fd",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "ìŠ¤ìœ„ì¹˜ í† ê¸€ ì‹œ í˜„ìž¬ìƒíƒœ ìž¬í‘œì‹œ",
        "func": "const enabled = (msg.payload === true);\nif (!enabled) { return [{}, {payload:'OFF'}]; }\nconst now = new Date();\nconst hour = now.getHours();\nconst minutes = now.getMinutes();\nconst text = (hour >= 5 && hour < 23) ? 'ON' : 'OFF';\n// const text = (minutes >= 25 && minutes < 26) ? 'ON' : 'OFF';\nreturn [ {payload: Date.now()}, {payload: text} ];",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 660,
        "y": 1600,
        "wires": [
            [
                "e5c0943a8969389f"
            ],
            [
                "7b17019d9694c425"
            ]
        ]
    },
    {
        "id": "a807676ee13f76fc",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "flow.enable ì €ìž¥",
        "func": "flow.set('circulator_enable', msg.payload === true);\nreturn null;",
        "outputs": 0,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 610,
        "y": 1560,
        "wires": []
    },
    {
        "id": "7b17019d9694c425",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "group": "f325796ebb721579",
        "order": 8,
        "width": 4,
        "height": 1,
        "name": "Circulator Status",
        "label": "Circulator Status",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 970,
        "y": 1580,
        "wires": []
    },
    {
        "id": "inp_a_ml",
        "type": "ui_text_input",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "injection volume A and B",
        "label": "A, B input volume",
        "tooltip": "",
        "group": "f325796ebb721579",
        "order": 12,
        "width": 4,
        "height": 1,
        "passthru": true,
        "mode": "number",
        "delay": 300,
        "topic": "",
        "sendOnBlur": true,
        "className": "",
        "topicType": "str",
        "x": 210,
        "y": 2980,
        "wires": [
            [
                "fn_a_save_ml"
            ]
        ]
    },
    {
        "id": "fn_a_save_ml",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "ìœ ëŸ‰ ì €ìž¥ + ì‹œê°„(ì´ˆ) ê³„ì‚°",
        "func": "const ml = Number(msg.payload);\nif (isNaN(ml) || ml <= 0) return null;\n// 1.613 ml/s ê°€ì • â†’ sec = ml / 1.613\n// const secRaw = ml / 1.613;\n// const secRaw = ml / 1.6667;\nconst secRaw = ml / 1.65;\nconst secDisp = Math.round(secRaw * 10) / 10; // í‘œì‹œìš© ì†Œìˆ˜1ìžë¦¬\nflow.set(\"dist_1_pumpA_volume_ml\", ml);\nflow.set(\"dist_1_pumpA_duration_sec\", secRaw);\nreturn { payload: `${ml} ml (${secDisp} s)` };",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 490,
        "y": 2980,
        "wires": [
            [
                "txt_a_current"
            ]
        ]
    },
    {
        "id": "txt_a_current",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "group": "f325796ebb721579",
        "order": 14,
        "width": 4,
        "height": 1,
        "name": "Setting",
        "label": "AB Setting",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 750,
        "y": 2980,
        "wires": []
    },
    {
        "id": "btn_a_run",
        "type": "ui_button",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "Start injecting solutions A and B",
        "group": "f325796ebb721579",
        "order": 16,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Start injecting A and B",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 190,
        "y": 3040,
        "wires": [
            [
                "fn_a_run_ml"
            ]
        ]
    },
    {
        "id": "fn_a_run_ml",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "GPIO25 ONâ†’ê³„ì‚°ì´ˆ í›„ OFF + ë¡œê·¸/í‘œì‹œ(ì‹œìž‘ë§Œ ê¸°ë¡)",
        "func": "const ml = Number(flow.get(\"dist_1_pumpA_volume_ml\"));\nconst sec = Number(flow.get(\"dist_1_pumpA_duration_sec\"));\nif (!ml || isNaN(ml) || !sec || isNaN(sec)) {\n  node.warn(\"ë¨¼ì € ABì•¡ íˆ¬ìž…ëŸ‰(ml)ì„ ìž…ë ¥í•˜ì„¸ìš”\");\n  return null\n}\n// ì¤‘ë³µ ì‹¤í–‰ íƒ€ì´ë¨¸ ì •ë¦¬\nconst key = \"dist_1_pumpA_timer\";\nconst prev = context.get(key);\nif (prev) { clearTimeout(prev); context.set(key, null); }\n\n// ì¦‰ì‹œ ON(0) + CSV 1íšŒ ê¸°ë¡(START) + UI ê°±ì‹ \nnode.send([\n  { payload: 0 },                                  // GPIO ON (0)\n  makeCsvMsg(\"PUMP_AB_START\", ml, sec),             // CSV: ì‹œìž‘ë§Œ ê¸°ë¡\n  makeUiMsg(\"Start\")                            // UI\n]);\n\n// sec í›„ OFF(1) â€” CSV ê¸°ë¡ ì—†ìŒ, UIë§Œ ê°±ì‹ \nconst timer = setTimeout(() => {\n  node.send([\n    { payload: 1 },                                // GPIO OFF (1)\n    null,                                          // CSV ì—†ìŒ\n    makeUiMsg(\"Complete\")                          // UI\n  ]);\n  context.set(key, null);\n}, Math.max(0, sec * 1000));\ncontext.set(key, timer);\nreturn null;\n\nfunction makeCsvMsg(action, ml, sec){\n  const ts = nowStr();\n  const secDisp = Math.round(sec*10)/10;\n  return { payload: `${ts},AB,volume,${ml},duration,${secDisp}s` };\n}\nfunction makeUiMsg(tag){\n  const ts = nowStr();\n  return { payload: `Last Run: ${ts} (${tag})` };\n}\nfunction nowStr(){\n  const now = new Date();\n  const yyyy = now.getFullYear();\n  const mm = String(now.getMonth()+1).padStart(2, '0');\n  const dd = String(now.getDate()).padStart(2, '0');\n  const hh = String(now.getHours()).padStart(2, '0');\n  const mi = String(now.getMinutes()).padStart(2, '0');\n  const ss = String(now.getSeconds()).padStart(2, '0');\n  return `${yyyy}-${mm}-${dd} ${hh}:${mi}:${ss}`;\n}",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 620,
        "y": 3040,
        "wires": [
            [
                "gpio25_out"
            ],
            [
                "file_a_csv"
            ],
            [
                "txt_a_last"
            ]
        ]
    },
    {
        "id": "gpio25_out",
        "type": "rpi-gpio out",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "GPIO17 (0=ON,1=OFF)",
        "pin": "17",
        "set": true,
        "level": "1",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 990,
        "y": 3020,
        "wires": []
    },
    {
        "id": "txt_a_last",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "group": "f325796ebb721579",
        "order": 18,
        "width": 8,
        "height": 1,
        "name": "Recent inputs (A, B)",
        "label": "Recent inputs (A, B)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1040,
        "y": 3060,
        "wires": []
    },
    {
        "id": "file_a_csv",
        "type": "file",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "A, Bì•¡ ë¡œê·¸ CSV",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_1_Solution_input_log.csv",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 1040,
        "y": 3120,
        "wires": [
            []
        ]
    },
    {
        "id": "inj_a_header",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "í—¤ë” 1íšŒ ê¸°ë¡",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.5,
        "topic": "",
        "payload": "timestamp,device,action,detail",
        "payloadType": "str",
        "x": 240,
        "y": 3120,
        "wires": [
            [
                "fn_a_header_guard"
            ]
        ]
    },
    {
        "id": "fn_a_header_guard",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "í—¤ë” ì¤‘ë³µ ë°©ì§€",
        "func": "if (flow.get('pumpA_csv_header_written')) return null;\nflow.set('pumpA_csv_header_written', true);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 460,
        "y": 3120,
        "wires": [
            [
                "file_a_csv"
            ]
        ]
    },
    {
        "id": "e10e368c452dd270",
        "type": "ui_text_input",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "injection volume Acid",
        "label": "Acid input volume",
        "tooltip": "",
        "group": "f325796ebb721579",
        "order": 13,
        "width": 4,
        "height": 1,
        "passthru": true,
        "mode": "number",
        "delay": 300,
        "topic": "",
        "sendOnBlur": true,
        "className": "",
        "topicType": "str",
        "x": 230,
        "y": 3220,
        "wires": [
            [
                "2b753df6afdd64b6"
            ]
        ]
    },
    {
        "id": "2b753df6afdd64b6",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "ìœ ëŸ‰ ì €ìž¥ + ì‹œê°„(ì´ˆ) ê³„ì‚°",
        "func": "const ml = Number(msg.payload);\nif (isNaN(ml) || ml <= 0) return null;\n// 1.613 ml/s ê°€ì • â†’ sec = ml / 1.613\n// const secRaw = ml / 1.613;\n// const secRaw = ml / 1.6667;\nconst secRaw = ml / 1.65;\nconst secDisp = Math.round(secRaw * 10) / 10; // í‘œì‹œìš© ì†Œìˆ˜1ìžë¦¬\nflow.set(\"dist_1_pumpC_volume_ml\", ml);\nflow.set(\"dist_1_pumpC_duration_sec\", secRaw);\nreturn { payload: `${ml} ml (${secDisp} s)` };",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 490,
        "y": 3220,
        "wires": [
            [
                "eaae89fb0638005f"
            ]
        ]
    },
    {
        "id": "eaae89fb0638005f",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "group": "f325796ebb721579",
        "order": 15,
        "width": 4,
        "height": 1,
        "name": "Setting",
        "label": "Acid Setting",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 750,
        "y": 3220,
        "wires": []
    },
    {
        "id": "a87b84159b60d57f",
        "type": "ui_button",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "Start injecting Acid solutions",
        "group": "f325796ebb721579",
        "order": 17,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Start injecting Acid",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 180,
        "y": 3280,
        "wires": [
            [
                "7284d4e9e0010867"
            ]
        ]
    },
    {
        "id": "7284d4e9e0010867",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "GPIO25 ONâ†’ê³„ì‚°ì´ˆ í›„ OFF + ë¡œê·¸/í‘œì‹œ(ì‹œìž‘ë§Œ ê¸°ë¡)",
        "func": "const ml = Number(flow.get(\"dist_1_pumpC_volume_ml\"));\nconst sec = Number(flow.get(\"dist_1_pumpC_duration_sec\"));\nif (!ml || isNaN(ml) || !sec || isNaN(sec)) {\n  node.warn(\"ë¨¼ì € Cì•¡ íˆ¬ìž…ëŸ‰(ml)ì„ ìž…ë ¥í•˜ì„¸ìš”\");\n  return null;\n}\n// ì¤‘ë³µ ì‹¤í–‰ íƒ€ì´ë¨¸ ì •ë¦¬\nconst key = \"dist_1_pumpC_timer\";\nconst prev = context.get(key);\nif (prev) { clearTimeout(prev); context.set(key, null); }\n\n// ì¦‰ì‹œ ON(0) + CSV 1íšŒ ê¸°ë¡(START) + UI ê°±ì‹ \nnode.send([\n  { payload: 0 },                                  // GPIO ON (0)\n  makeCsvMsg(\"PUMP_C_START\", ml, sec),             // CSV: ì‹œìž‘ë§Œ ê¸°ë¡\n  makeUiMsg(\"Start\")                            // UI\n]);\n\n// sec í›„ OFF(1) â€” CSV ê¸°ë¡ ì—†ìŒ, UIë§Œ ê°±ì‹ \nconst timer = setTimeout(() => {\n  node.send([\n    { payload: 1 },                                // GPIO OFF (1)\n    null,                                          // CSV ì—†ìŒ\n    makeUiMsg(\"Complete\")                          // UI\n  ]);\n  context.set(key, null);\n}, Math.max(0, sec * 1000));\ncontext.set(key, timer);\nreturn null;\n\nfunction makeCsvMsg(action, ml, sec){\n  const ts = nowStr();\n  const secDisp = Math.round(sec*10)/10;\n  return { payload: `${ts},Acid,volume,${ml},duration,${secDisp}s` };\n}\nfunction makeUiMsg(tag){\n  const ts = nowStr();\n  return { payload: `Last Run: ${ts} (${tag})` };\n}\nfunction nowStr(){\n  const now = new Date();\n  const yyyy = now.getFullYear();\n  const mm = String(now.getMonth()+1).padStart(2, '0');\n  const dd = String(now.getDate()).padStart(2, '0');\n  const hh = String(now.getHours()).padStart(2, '0');\n  const mi = String(now.getMinutes()).padStart(2, '0');\n  const ss = String(now.getSeconds()).padStart(2, '0');\n  return `${yyyy}-${mm}-${dd} ${hh}:${mi}:${ss}`;\n}",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 540,
        "y": 3280,
        "wires": [
            [
                "1a838d3ee158ae54"
            ],
            [
                "6dddb568535969eb"
            ],
            [
                "6044e01bb19ae4bc"
            ]
        ]
    },
    {
        "id": "1a838d3ee158ae54",
        "type": "rpi-gpio out",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "GPIO21 (0=ON,1=OFF)",
        "pin": "21",
        "set": true,
        "level": "1",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 990,
        "y": 3260,
        "wires": []
    },
    {
        "id": "6044e01bb19ae4bc",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "group": "f325796ebb721579",
        "order": 19,
        "width": 8,
        "height": 1,
        "name": "Recent inputs (Acid)",
        "label": "Recent inputs (Acid)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1000,
        "y": 3300,
        "wires": []
    },
    {
        "id": "6dddb568535969eb",
        "type": "file",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "ì‚°ì„±ì•¡ ë¡œê·¸ CSV",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_1_Solution_input_log.csv",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 980,
        "y": 3360,
        "wires": [
            []
        ]
    },
    {
        "id": "7715901eb0e673bd",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "í—¤ë” 1íšŒ ê¸°ë¡",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.5,
        "topic": "",
        "payload": "timestamp,device,action,detail",
        "payloadType": "str",
        "x": 240,
        "y": 3360,
        "wires": [
            [
                "f97336f95369f779"
            ]
        ]
    },
    {
        "id": "f97336f95369f779",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "í—¤ë” ì¤‘ë³µ ë°©ì§€",
        "func": "if (flow.get('pumpA_csv_header_written')) return null;\nflow.set('pumpA_csv_header_written', true);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 460,
        "y": 3360,
        "wires": [
            [
                "6dddb568535969eb"
            ]
        ]
    },
    {
        "id": "577253202c73b09c",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "915bc3b1ca228f03",
        "name": "Dist 1 Pump controller",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/Dist_1_PumpController.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 520,
        "y": 2320,
        "wires": [
            [
                "839c019b8d38b1ce"
            ]
        ]
    },
    {
        "id": "3725b711ea5e2772",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "915bc3b1ca228f03",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 280,
        "y": 2320,
        "wires": [
            [
                "577253202c73b09c"
            ]
        ]
    },
    {
        "id": "839c019b8d38b1ce",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "915bc3b1ca228f03",
        "name": "debug 10",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 720,
        "y": 2320,
        "wires": []
    },
    {
        "id": "2338e23a2b4a1061",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "g": "915bc3b1ca228f03",
        "name": "",
        "label": "Pump",
        "tooltip": "",
        "group": "f325796ebb721579",
        "order": 10,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "false",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "true",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 110,
        "y": 2320,
        "wires": [
            [
                "3725b711ea5e2772"
            ]
        ]
    },
    {
        "id": "7164aeb31763ab09",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "915bc3b1ca228f03",
        "group": "f325796ebb721579",
        "order": 9,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "Nutrient solution control",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "style": true,
        "font": "Arial,Arial,Helvetica,sans-serif",
        "fontSize": "25",
        "color": "#ffffff",
        "x": 170,
        "y": 2260,
        "wires": []
    },
    {
        "id": "996be92bd9d2ab16",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "name": "UV Automation",
        "label": "UV Automation",
        "tooltip": "",
        "group": "f325796ebb721579",
        "order": 3,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "topicType": "str",
        "style": "",
        "onvalue": "false",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "true",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 160,
        "y": 2180,
        "wires": [
            [
                "7def7b8e65cbddcc"
            ]
        ]
    },
    {
        "id": "a19b61fd61a05499",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "name": "Dist_1_UV controller",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/Dist_1_UVController.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 580,
        "y": 2180,
        "wires": [
            [
                "34196794c1698420"
            ]
        ]
    },
    {
        "id": "7def7b8e65cbddcc",
        "type": "change",
        "z": "84f9df6667326f98",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 340,
        "y": 2180,
        "wires": [
            [
                "a19b61fd61a05499"
            ]
        ]
    },
    {
        "id": "34196794c1698420",
        "type": "debug",
        "z": "84f9df6667326f98",
        "name": "debug 11",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 780,
        "y": 2180,
        "wires": []
    },
    {
        "id": "1753d4563875309b",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "Solution Temperature",
        "rules": [
            {
                "t": "move",
                "p": "payload.Solution_Temperature",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 1100,
        "wires": [
            [
                "1aa3bbe8afdc012d",
                "7e26ce5601b49a9c",
                "27b92651c8adebe9"
            ]
        ]
    },
    {
        "id": "1aa3bbe8afdc012d",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "Dist 1 S.T",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 920,
        "y": 1100,
        "wires": []
    },
    {
        "id": "7e26ce5601b49a9c",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "",
        "group": "c5fb925fb5ca84e9",
        "order": 3,
        "width": 6,
        "height": 5,
        "gtype": "gage",
        "title": "Solution Temperature",
        "label": "CÂº",
        "format": "{{value}}",
        "min": "0",
        "max": "30",
        "colors": [
            "#b50000",
            "#00b500",
            "#b50000"
        ],
        "seg1": "17",
        "seg2": "23",
        "diff": false,
        "className": "",
        "x": 960,
        "y": 1160,
        "wires": []
    },
    {
        "id": "27b92651c8adebe9",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "e8ce93fc01bd7af9",
        "name": "",
        "group": "",
        "order": 8,
        "width": 6,
        "height": 5,
        "label": "Solution Temperature",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "30",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 960,
        "y": 1200,
        "wires": [
            []
        ]
    },
    {
        "id": "d3d5c208297b5bcb",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "CO2",
        "rules": [
            {
                "t": "move",
                "p": "payload.co2",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 460,
        "wires": [
            [
                "ce91a081135d3653",
                "a81d2b73695ec428",
                "f033277dce8c9fc3"
            ]
        ]
    },
    {
        "id": "ce91a081135d3653",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "CO2 debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 440,
        "wires": []
    },
    {
        "id": "a81d2b73695ec428",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "",
        "group": "c888f82b8cc4653a",
        "order": 3,
        "width": 6,
        "height": 5,
        "gtype": "gage",
        "title": "CO2",
        "label": "ppm",
        "format": "{{value}}",
        "min": "30",
        "max": "1000",
        "colors": [
            "#ca3838",
            "#00b500",
            "#ca3838"
        ],
        "seg1": "300",
        "seg2": "800",
        "diff": false,
        "className": "",
        "x": 910,
        "y": 480,
        "wires": []
    },
    {
        "id": "f033277dce8c9fc3",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "17b6e50d0d55a4f0",
        "name": "",
        "group": "",
        "order": 24,
        "width": 6,
        "height": 5,
        "label": "CO2",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "30",
        "ymax": "1000",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 910,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "1caf8a5c5e3446a5",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "Solution Temperature",
        "rules": [
            {
                "t": "move",
                "p": "payload.Solution_Temperature",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1820,
        "y": 1100,
        "wires": [
            [
                "25a1fc18f884cf3a",
                "12a11f4918b20262",
                "ada6e5f91605f50b"
            ]
        ]
    },
    {
        "id": "25a1fc18f884cf3a",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "Dist 2 S.T",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2060,
        "y": 1100,
        "wires": []
    },
    {
        "id": "12a11f4918b20262",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "",
        "group": "aa578847983587e6",
        "order": 3,
        "width": 6,
        "height": 5,
        "gtype": "gage",
        "title": "Solution Temperature",
        "label": "CÂº",
        "format": "{{value}}",
        "min": "0",
        "max": "30",
        "colors": [
            "#b50000",
            "#00b500",
            "#b50000"
        ],
        "seg1": "17",
        "seg2": "23",
        "diff": false,
        "className": "",
        "x": 2100,
        "y": 1160,
        "wires": []
    },
    {
        "id": "ada6e5f91605f50b",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "3eaca329610704eb",
        "name": "",
        "group": "",
        "order": 8,
        "width": 6,
        "height": 5,
        "label": "Solution Temperature",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "30",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 2100,
        "y": 1200,
        "wires": [
            []
        ]
    },
    {
        "id": "ded04047b201eda5",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "2",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1260,
        "y": 680,
        "wires": [
            [
                "3f103b9815f86dd4"
            ]
        ]
    },
    {
        "id": "3f103b9815f86dd4",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "Dist_2_EC_pH",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_2_EC_pH.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 1460,
        "y": 680,
        "wires": [
            [
                "27c51267c346f89a"
            ]
        ]
    },
    {
        "id": "27c51267c346f89a",
        "type": "json",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1610,
        "y": 680,
        "wires": [
            [
                "882bd2a1db484c7a",
                "83ef16bf59648dba",
                "523fb7d4146c728e",
                "23d54e14bb05b234",
                "1caf8a5c5e3446a5"
            ]
        ]
    },
    {
        "id": "882bd2a1db484c7a",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "3eaca329610704eb",
        "name": "Date str",
        "rules": [
            {
                "t": "move",
                "p": "payload.date",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1800,
        "y": 680,
        "wires": [
            [
                "2c23a9c69bfd5964"
            ]
        ]
    },
    {
        "id": "83ef16bf59648dba",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "EC",
        "rules": [
            {
                "t": "move",
                "p": "payload.EC",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1790,
        "y": 740,
        "wires": [
            [
                "19575127be6263da",
                "55c7596a34b371e7",
                "10a137bf882b5184"
            ]
        ]
    },
    {
        "id": "523fb7d4146c728e",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "pH",
        "rules": [
            {
                "t": "move",
                "p": "payload.pH",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1790,
        "y": 940,
        "wires": [
            [
                "7c25ba5dd16a36b6",
                "1b55bb39740ed3db",
                "1236be8eabaf376f"
            ]
        ]
    },
    {
        "id": "19575127be6263da",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "Dist 2 EC",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2000,
        "y": 740,
        "wires": []
    },
    {
        "id": "7c25ba5dd16a36b6",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "Dist 2 pH",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2000,
        "y": 940,
        "wires": []
    },
    {
        "id": "2c23a9c69bfd5964",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "3eaca329610704eb",
        "name": "Date str to date",
        "func": "// Get the input string from msg.payload\nlet valueString = msg.payload;  // e.g., \"2025-06-17 18:13\"\n\n// Replace space with 'T' to ensure proper ISO 8601 format\nlet isoFormat = valueString.replace(\" \", \"T\");\n\n// Convert the string to a JavaScript Date object\nlet dateObj = new Date(isoFormat);\nmsg.payload = dateObj\n\n// Check if the date is valid\n//if (isNaN(dateObj.getTime())) {\n//    msg.payload = { error: \"Invalid date format\" };\n//} else {\n//    msg.payload = {\n//        original: valueString,\n//        date: dateObj\n//    };\n//}\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1980,
        "y": 680,
        "wires": [
            [
                "bed3ea5061f3aa42"
            ]
        ]
    },
    {
        "id": "bed3ea5061f3aa42",
        "type": "debug",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "3eaca329610704eb",
        "name": "debug 17",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 2160,
        "y": 680,
        "wires": []
    },
    {
        "id": "55c7596a34b371e7",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "",
        "group": "aa578847983587e6",
        "order": 1,
        "width": 6,
        "height": 5,
        "gtype": "gage",
        "title": "EC",
        "label": "mS/cm",
        "format": "{{value}}",
        "min": "0",
        "max": "3",
        "colors": [
            "#00b500",
            "#00b500",
            "#b50000"
        ],
        "seg1": "",
        "seg2": "1.8",
        "diff": false,
        "className": "",
        "x": 2010,
        "y": 800,
        "wires": []
    },
    {
        "id": "1b55bb39740ed3db",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "",
        "group": "aa578847983587e6",
        "order": 2,
        "width": 6,
        "height": 5,
        "gtype": "gage",
        "title": "pH",
        "label": "",
        "format": "{{value}}",
        "min": "0",
        "max": "10",
        "colors": [
            "#b50000",
            "#00b500",
            "#b50000"
        ],
        "seg1": "5.5",
        "seg2": "7",
        "diff": false,
        "className": "",
        "x": 2010,
        "y": 1000,
        "wires": []
    },
    {
        "id": "10a137bf882b5184",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "3eaca329610704eb",
        "name": "",
        "group": "",
        "order": 9,
        "width": 6,
        "height": 5,
        "label": "EC",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "3",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 2010,
        "y": 860,
        "wires": [
            []
        ]
    },
    {
        "id": "1236be8eabaf376f",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "3eaca329610704eb",
        "name": "",
        "group": "",
        "order": 7,
        "width": 6,
        "height": 5,
        "label": "pH",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "10",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 2010,
        "y": 1040,
        "wires": [
            []
        ]
    },
    {
        "id": "23d54e14bb05b234",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "debug 18",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1760,
        "y": 620,
        "wires": []
    },
    {
        "id": "ui_auto_switch",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "name": "Auto Mode",
        "label": "Auto mode",
        "tooltip": "",
        "group": "f325796ebb721579",
        "order": 11,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "topicType": "str",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 150,
        "y": 3460,
        "wires": [
            [
                "fn_set_auto_flag",
                "b17d8c4a3bca04cb",
                "9bacb98be36f37dc"
            ]
        ]
    },
    {
        "id": "fn_set_auto_flag",
        "type": "function",
        "z": "84f9df6667326f98",
        "name": "set flow.auto_mode",
        "func": "flow.set('auto_mode', !!msg.payload);\nreturn {payload: flow.get('auto_mode')};",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 3460,
        "wires": [
            []
        ]
    },
    {
        "id": "b17d8c4a3bca04cb",
        "type": "change",
        "z": "84f9df6667326f98",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 340,
        "y": 3520,
        "wires": [
            [
                "7cf8ec733dff273c",
                "564506cb197cc954"
            ]
        ]
    },
    {
        "id": "7cf8ec733dff273c",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "name": "Dist 1 EC pH Automation",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/Dist_1_EC_pH_auto_control.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 590,
        "y": 3520,
        "wires": [
            [
                "57f723a2128c43d5"
            ]
        ]
    },
    {
        "id": "661835450f15a6b4",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "ad1743f076448914",
        "name": "UV Automation",
        "label": "UV Automation",
        "tooltip": "",
        "group": "",
        "order": 4,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "topicType": "str",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 1060,
        "y": 2040,
        "wires": [
            [
                "32897822979abecd",
                "d3ac968ba6e2864f"
            ]
        ]
    },
    {
        "id": "d785e496788ff69d",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "ad1743f076448914",
        "group": "",
        "order": 5,
        "width": 3,
        "height": 1,
        "name": "UV Status",
        "label": "UV Status",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1650,
        "y": 2040,
        "wires": []
    },
    {
        "id": "32897822979abecd",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "ad1743f076448914",
        "name": "flow.enable ì €ìž¥",
        "func": "flow.set('uv_enable', msg.payload === true);\nreturn null;",
        "outputs": 0,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1310,
        "y": 2020,
        "wires": []
    },
    {
        "id": "c98d03a0abbedcbd",
        "type": "inject",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "ad1743f076448914",
        "name": "ë§¤ 10ë¶„ë§ˆë‹¤ ì‹¤í–‰",
        "props": [],
        "repeat": "600",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "x": 1070,
        "y": 2120,
        "wires": [
            [
                "aa04375898a1948b"
            ]
        ]
    },
    {
        "id": "aa04375898a1948b",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "ad1743f076448914",
        "name": "ìŠ¤ì¼€ì¤„ ONì¼ ë•Œë§Œ 1/0 ê²°ì • + ìƒíƒœë¬¸êµ¬",
        "func": "if (flow.get('uv_enable') !== true) return null;\nconst now = new Date();\nconst hour = now.getHours(); \nconst minutes = now.getMinutes();\nlet val = 1;               // ê¸°ë³¸ OFF(1)\nlet text = 'OFF';\nif (hour >= 1 && hour < 13) { val = 0; text = 'ON'; }\n// if (minutes >= 25 && minutes < 26) { val = 0; text = 'ON'; }\n// ì¶œë ¥1: GPIO, ì¶œë ¥2: ìƒíƒœë¬¸êµ¬\nreturn [ {payload: val}, {payload: text} ];\n\n// if (flow.get('uv_enable') !== true) return null;\n// í˜„ìž¬ ì‹œê°„(hour) ê°€ì ¸ì˜¤ê¸°\n// let now = new Date();\n// let hour = now.getHours();\n// let minutes = now.getMinutes();\n// let pinState = 1;              // ê¸°ë³¸ OFF(1)\n// let text = 'OFF';\n\n\n// // 00ì‹œ ~ 06ì‹œ ì‚¬ì´ ON (0)\n// // if (hour >= 0 && hour < 6) {\n// if (minutes >= 22 && minutes < 23) {\n//     pinState = 0; // ON\n// } else {\n//     pinState = 1; // OFF\n// }\n\n// msg.payload = pinState;\n// return msg;",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1370,
        "y": 2120,
        "wires": [
            [
                "9f360e5a54c95af6"
            ],
            [
                "d785e496788ff69d"
            ]
        ]
    },
    {
        "id": "d3ac968ba6e2864f",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "ad1743f076448914",
        "name": "ìŠ¤ìœ„ì¹˜ í† ê¸€ ì‹œ í˜„ìž¬ìƒíƒœ ìž¬í‘œì‹œ",
        "func": "const enabled = (msg.payload === true);\nif (!enabled) { return [{}, {payload:'OFF'}]; }\nconst now = new Date();\nconst hour = now.getHours();\nconst minutes = now.getMinutes();\nconst text = (hour >= 1 && hour < 3) ? 'ON' : 'OFF';\n// const text = (minutes >= 25 && minutes < 26) ? 'ON' : 'OFF';\nreturn [ {payload: Date.now()}, {payload: text} ];",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1360,
        "y": 2060,
        "wires": [
            [
                "aa04375898a1948b"
            ],
            [
                "d785e496788ff69d"
            ]
        ]
    },
    {
        "id": "9f360e5a54c95af6",
        "type": "rpi-gpio out",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "ad1743f076448914",
        "name": "GPIO18 (pin 12)",
        "pin": "18",
        "set": true,
        "level": "1",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 1680,
        "y": 2120,
        "wires": []
    },
    {
        "id": "7a499e2de11fb75a",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "ad1743f076448914",
        "name": "Dist_2_LED controller",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/Dist_2_LEDController.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 1420,
        "y": 1940,
        "wires": [
            [
                "0b9b9d5aae2018ff"
            ]
        ]
    },
    {
        "id": "e08d25bb4b05e048",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "ad1743f076448914",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1180,
        "y": 1940,
        "wires": [
            [
                "7a499e2de11fb75a"
            ]
        ]
    },
    {
        "id": "0b9b9d5aae2018ff",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "ad1743f076448914",
        "name": "debug 19",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1600,
        "y": 1940,
        "wires": []
    },
    {
        "id": "ef29638c34485786",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "g": "ad1743f076448914",
        "name": "",
        "label": "LED",
        "tooltip": "",
        "group": "e3eac795c3a63651",
        "order": 2,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "false",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "true",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 1030,
        "y": 1940,
        "wires": [
            [
                "e08d25bb4b05e048"
            ]
        ]
    },
    {
        "id": "a1e65c136a4faf8e",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "ad1743f076448914",
        "group": "e3eac795c3a63651",
        "order": 1,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "Lighting",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "style": true,
        "font": "Arial,Arial,Helvetica,sans-serif",
        "fontSize": "25",
        "color": "#ffffff",
        "x": 1040,
        "y": 1880,
        "wires": []
    },
    {
        "id": "4f385e73050961e1",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "978a9587f7a84adc",
        "name": "Dist 2 Pump controller",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/Dist_2_PumpController.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 1400,
        "y": 2320,
        "wires": [
            [
                "63e650f897ae7cfe"
            ]
        ]
    },
    {
        "id": "f15e7c328f5d7fd4",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "978a9587f7a84adc",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1160,
        "y": 2320,
        "wires": [
            [
                "4f385e73050961e1"
            ]
        ]
    },
    {
        "id": "63e650f897ae7cfe",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "978a9587f7a84adc",
        "name": "debug 20",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1600,
        "y": 2320,
        "wires": []
    },
    {
        "id": "3aa9a7e96d4cfe09",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "g": "978a9587f7a84adc",
        "name": "",
        "label": "Pump",
        "tooltip": "",
        "group": "e3eac795c3a63651",
        "order": 7,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "false",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "true",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 990,
        "y": 2320,
        "wires": [
            [
                "f15e7c328f5d7fd4"
            ]
        ]
    },
    {
        "id": "e320eb5d6e113614",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "978a9587f7a84adc",
        "group": "e3eac795c3a63651",
        "order": 6,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "Nutrient solution control",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "style": true,
        "font": "Arial,Arial,Helvetica,sans-serif",
        "fontSize": "25",
        "color": "#ffffff",
        "x": 1050,
        "y": 2260,
        "wires": []
    },
    {
        "id": "032638cc6c5fc9f2",
        "type": "ui_text_input",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "injection volume A and B",
        "label": "A, B input volume",
        "tooltip": "",
        "group": "e3eac795c3a63651",
        "order": 9,
        "width": 4,
        "height": 1,
        "passthru": true,
        "mode": "number",
        "delay": 300,
        "topic": "",
        "sendOnBlur": true,
        "className": "",
        "topicType": "str",
        "x": 1430,
        "y": 2980,
        "wires": [
            [
                "742c215264b52d5d"
            ]
        ]
    },
    {
        "id": "742c215264b52d5d",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "ìœ ëŸ‰ ì €ìž¥ + ì‹œê°„(ì´ˆ) ê³„ì‚°",
        "func": "const ml = Number(msg.payload);\nif (isNaN(ml) || ml <= 0) return null;\n// 1.613 ml/s ê°€ì • â†’ sec = ml / 1.613\n// const secRaw = ml / 1.613;\n// const secRaw = ml / 1.6667;\nconst secRaw = ml / 1.65;\nconst secDisp = Math.round(secRaw * 10) / 10; // í‘œì‹œìš© ì†Œìˆ˜1ìžë¦¬\nflow.set(\"dist_2_pumpA_volume_ml\", ml);\nflow.set(\"dist_2_pumpA_duration_sec\", secRaw);\nreturn { payload: `${ml} ml (${secDisp} s)` };",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1710,
        "y": 2980,
        "wires": [
            [
                "66ddab9642e34173"
            ]
        ]
    },
    {
        "id": "66ddab9642e34173",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "group": "e3eac795c3a63651",
        "order": 11,
        "width": 4,
        "height": 1,
        "name": "Setting",
        "label": "AB Setting",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1970,
        "y": 2980,
        "wires": []
    },
    {
        "id": "e4a0abcae8745f5d",
        "type": "ui_button",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "Start injecting solutions A and B",
        "group": "e3eac795c3a63651",
        "order": 13,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Start injecting A and B",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 1410,
        "y": 3040,
        "wires": [
            [
                "80cc8c87a9dcdff5"
            ]
        ]
    },
    {
        "id": "80cc8c87a9dcdff5",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "GPIO25 ONâ†’ê³„ì‚°ì´ˆ í›„ OFF + ë¡œê·¸/í‘œì‹œ(ì‹œìž‘ë§Œ ê¸°ë¡)",
        "func": "const ml = Number(flow.get(\"dist_2_pumpA_volume_ml\"));\nconst sec = Number(flow.get(\"dist_2_pumpA_duration_sec\"));\nif (!ml || isNaN(ml) || !sec || isNaN(sec)) {\n  node.warn(\"ë¨¼ì € ABì•¡ íˆ¬ìž…ëŸ‰(ml)ì„ ìž…ë ¥í•˜ì„¸ìš”\");\n  return null;\n}\n// ì¤‘ë³µ ì‹¤í–‰ íƒ€ì´ë¨¸ ì •ë¦¬\nconst key = \"dist_2_pumpA_timer\";\nconst prev = context.get(key);\nif (prev) { clearTimeout(prev); context.set(key, null); }\n\n// ì¦‰ì‹œ ON(0) + CSV 1íšŒ ê¸°ë¡(START) + UI ê°±ì‹ \nnode.send([\n  { payload: 0 },                                  // GPIO ON (0)\n  makeCsvMsg(\"PUMP_AB_START\", ml, sec),             // CSV: ì‹œìž‘ë§Œ ê¸°ë¡\n  makeUiMsg(\"Start\")                            // UI\n]);\n\n// sec í›„ OFF(1) â€” CSV ê¸°ë¡ ì—†ìŒ, UIë§Œ ê°±ì‹ \nconst timer = setTimeout(() => {\n  node.send([\n    { payload: 1 },                                // GPIO OFF (1)\n    null,                                          // CSV ì—†ìŒ\n    makeUiMsg(\"Complete\")                          // UI\n  ]);\n  context.set(key, null);\n}, Math.max(0, sec * 1000));\ncontext.set(key, timer);\nreturn null;\n\nfunction makeCsvMsg(action, ml, sec){\n  const ts = nowStr();\n  const secDisp = Math.round(sec*10)/10;\n  return { payload: `${ts},AB,volume,${ml},duration,${secDisp}s` };\n}\nfunction makeUiMsg(tag){\n  const ts = nowStr();\n  return { payload: `Last Run: ${ts} (${tag})` };\n}\nfunction nowStr(){\n  const now = new Date();\n  const yyyy = now.getFullYear();\n  const mm = String(now.getMonth()+1).padStart(2, '0');\n  const dd = String(now.getDate()).padStart(2, '0');\n  const hh = String(now.getHours()).padStart(2, '0');\n  const mi = String(now.getMinutes()).padStart(2, '0');\n  const ss = String(now.getSeconds()).padStart(2, '0');\n  return `${yyyy}-${mm}-${dd} ${hh}:${mi}:${ss}`;\n}",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1840,
        "y": 3040,
        "wires": [
            [
                "c7fe5d35e20589ec"
            ],
            [
                "ce77e02c54e5281c"
            ],
            [
                "e0b97cfcaafbe7a8"
            ]
        ]
    },
    {
        "id": "c7fe5d35e20589ec",
        "type": "rpi-gpio out",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "GPIO22 (0=ON,1=OFF)",
        "pin": "22",
        "set": true,
        "level": "1",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 2210,
        "y": 3020,
        "wires": []
    },
    {
        "id": "e0b97cfcaafbe7a8",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "group": "e3eac795c3a63651",
        "order": 15,
        "width": 8,
        "height": 1,
        "name": "Recent inputs (A, B)",
        "label": "Recent inputs (A, B)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 2260,
        "y": 3060,
        "wires": []
    },
    {
        "id": "ce77e02c54e5281c",
        "type": "file",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "A, Bì•¡ ë¡œê·¸ CSV",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_2_Solution_input_log.csv",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 2260,
        "y": 3120,
        "wires": [
            []
        ]
    },
    {
        "id": "d77f241745577d87",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "í—¤ë” 1íšŒ ê¸°ë¡",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.5,
        "topic": "",
        "payload": "timestamp,device,action,detail",
        "payloadType": "str",
        "x": 1460,
        "y": 3120,
        "wires": [
            [
                "f7516acac2b29596"
            ]
        ]
    },
    {
        "id": "f7516acac2b29596",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "í—¤ë” ì¤‘ë³µ ë°©ì§€",
        "func": "if (flow.get('pumpA_csv_header_written')) return null;\nflow.set('pumpA_csv_header_written', true);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1680,
        "y": 3120,
        "wires": [
            [
                "ce77e02c54e5281c"
            ]
        ]
    },
    {
        "id": "abf0f3cd0103cc31",
        "type": "ui_text_input",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "injection volume Acid",
        "label": "Acid input volume",
        "tooltip": "",
        "group": "e3eac795c3a63651",
        "order": 10,
        "width": 4,
        "height": 1,
        "passthru": true,
        "mode": "number",
        "delay": 300,
        "topic": "",
        "sendOnBlur": true,
        "className": "",
        "topicType": "str",
        "x": 1450,
        "y": 3220,
        "wires": [
            [
                "083acd90c241f25d"
            ]
        ]
    },
    {
        "id": "083acd90c241f25d",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "ìœ ëŸ‰ ì €ìž¥ + ì‹œê°„(ì´ˆ) ê³„ì‚°",
        "func": "const ml = Number(msg.payload);\nif (isNaN(ml) || ml <= 0) return null;\n// 1.613 ml/s ê°€ì • â†’ sec = ml / 1.613\n// const secRaw = ml / 1.613;\n// const secRaw = ml / 1.6667;\nconst secRaw = ml / 1.65;\nconst secDisp = Math.round(secRaw * 10) / 10; // í‘œì‹œìš© ì†Œìˆ˜1ìžë¦¬\nflow.set(\"dist_2_pumpC_volume_ml\", ml);\nflow.set(\"dist_2_pumpC_duration_sec\", secRaw);\nreturn { payload: `${ml} ml (${secDisp} s)` };",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1710,
        "y": 3220,
        "wires": [
            [
                "972eec39af78be9a"
            ]
        ]
    },
    {
        "id": "972eec39af78be9a",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "group": "e3eac795c3a63651",
        "order": 12,
        "width": 4,
        "height": 1,
        "name": "Setting",
        "label": "Acid Setting",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1970,
        "y": 3220,
        "wires": []
    },
    {
        "id": "ada5f246a3285a35",
        "type": "ui_button",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "Start injecting Acid solutions",
        "group": "e3eac795c3a63651",
        "order": 14,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Start injecting Acid",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 1400,
        "y": 3280,
        "wires": [
            [
                "67dfe99f35a05924"
            ]
        ]
    },
    {
        "id": "67dfe99f35a05924",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "GPIO25 ONâ†’ê³„ì‚°ì´ˆ í›„ OFF + ë¡œê·¸/í‘œì‹œ(ì‹œìž‘ë§Œ ê¸°ë¡)",
        "func": "const ml = Number(flow.get(\"dist_2_pumpC_volume_ml\"));\nconst sec = Number(flow.get(\"dist_2_pumpC_duration_sec\"));\nif (!ml || isNaN(ml) || !sec || isNaN(sec)) {\n  node.warn(\"ë¨¼ì € Cì•¡ íˆ¬ìž…ëŸ‰(ml)ì„ ìž…ë ¥í•˜ì„¸ìš”\");\n  return null;\n}\n// ì¤‘ë³µ ì‹¤í–‰ íƒ€ì´ë¨¸ ì •ë¦¬\nconst key = \"dist_2_pumpC_timer\";\nconst prev = context.get(key);\nif (prev) { clearTimeout(prev); context.set(key, null); }\n\n// ì¦‰ì‹œ ON(0) + CSV 1íšŒ ê¸°ë¡(START) + UI ê°±ì‹ \nnode.send([\n  { payload: 0 },                                  // GPIO ON (0)\n  makeCsvMsg(\"PUMP_C_START\", ml, sec),             // CSV: ì‹œìž‘ë§Œ ê¸°ë¡\n  makeUiMsg(\"Start\")                            // UI\n]);\n\n// sec í›„ OFF(1) â€” CSV ê¸°ë¡ ì—†ìŒ, UIë§Œ ê°±ì‹ \nconst timer = setTimeout(() => {\n  node.send([\n    { payload: 1 },                                // GPIO OFF (1)\n    null,                                          // CSV ì—†ìŒ\n    makeUiMsg(\"Complete\")                          // UI\n  ]);\n  context.set(key, null);\n}, Math.max(0, sec * 1000));\ncontext.set(key, timer);\nreturn null;\n\nfunction makeCsvMsg(action, ml, sec){\n  const ts = nowStr();\n  const secDisp = Math.round(sec*10)/10;\n  return { payload: `${ts},Acid,volume,${ml},duration,${secDisp}s` };\n}\nfunction makeUiMsg(tag){\n  const ts = nowStr();\n  return { payload: `Last Run: ${ts} (${tag})` };\n}\nfunction nowStr(){\n  const now = new Date();\n  const yyyy = now.getFullYear();\n  const mm = String(now.getMonth()+1).padStart(2, '0');\n  const dd = String(now.getDate()).padStart(2, '0');\n  const hh = String(now.getHours()).padStart(2, '0');\n  const mi = String(now.getMinutes()).padStart(2, '0');\n  const ss = String(now.getSeconds()).padStart(2, '0');\n  return `${yyyy}-${mm}-${dd} ${hh}:${mi}:${ss}`;\n}",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1760,
        "y": 3280,
        "wires": [
            [
                "21fc1765b77482f9"
            ],
            [
                "8bfc716cf46fb70d"
            ],
            [
                "f37eddb8c684e4ec"
            ]
        ]
    },
    {
        "id": "21fc1765b77482f9",
        "type": "rpi-gpio out",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "GPIO23 (0=ON,1=OFF)",
        "pin": "23",
        "set": true,
        "level": "1",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 2210,
        "y": 3260,
        "wires": []
    },
    {
        "id": "f37eddb8c684e4ec",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "group": "e3eac795c3a63651",
        "order": 16,
        "width": 8,
        "height": 1,
        "name": "Recent inputs (Acid)",
        "label": "Recent inputs (Acid)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 2220,
        "y": 3300,
        "wires": []
    },
    {
        "id": "8bfc716cf46fb70d",
        "type": "file",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "ì‚°ì„±ì•¡ ë¡œê·¸ CSV",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_2_Solution_input_log.csv",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 2200,
        "y": 3360,
        "wires": [
            []
        ]
    },
    {
        "id": "d4e056cc41c01da1",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "í—¤ë” 1íšŒ ê¸°ë¡",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.5,
        "topic": "",
        "payload": "timestamp,device,action,detail",
        "payloadType": "str",
        "x": 1460,
        "y": 3360,
        "wires": [
            [
                "78091ee38cd1e0cc"
            ]
        ]
    },
    {
        "id": "78091ee38cd1e0cc",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "í—¤ë” ì¤‘ë³µ ë°©ì§€",
        "func": "if (flow.get('pumpA_csv_header_written')) return null;\nflow.set('pumpA_csv_header_written', true);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1680,
        "y": 3360,
        "wires": [
            [
                "8bfc716cf46fb70d"
            ]
        ]
    },
    {
        "id": "e915b915a2f01c1b",
        "type": "debug",
        "z": "84f9df6667326f98",
        "name": "debug 21",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1640,
        "y": 2200,
        "wires": []
    },
    {
        "id": "9396d3ba5291459f",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "name": "Dist_2_UV controller",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/Dist_2_UVController.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 1440,
        "y": 2200,
        "wires": [
            [
                "e915b915a2f01c1b"
            ]
        ]
    },
    {
        "id": "d70b2a7a62c2872f",
        "type": "change",
        "z": "84f9df6667326f98",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1200,
        "y": 2200,
        "wires": [
            [
                "9396d3ba5291459f"
            ]
        ]
    },
    {
        "id": "004ded11443e61e3",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "name": "UV Automation",
        "label": "UV Automation",
        "tooltip": "",
        "group": "e3eac795c3a63651",
        "order": 3,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "topicType": "str",
        "style": "",
        "onvalue": "false",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "true",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 1020,
        "y": 2200,
        "wires": [
            [
                "d70b2a7a62c2872f"
            ]
        ]
    },
    {
        "id": "87d673785a0f96f7",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "name": "",
        "label": "Fan",
        "tooltip": "",
        "group": "e3eac795c3a63651",
        "order": 4,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "false",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "true",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 1050,
        "y": 1800,
        "wires": [
            [
                "eaabd177f90f6e07"
            ]
        ]
    },
    {
        "id": "eaabd177f90f6e07",
        "type": "change",
        "z": "84f9df6667326f98",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1220,
        "y": 1800,
        "wires": [
            [
                "07b2bd530ce25200"
            ]
        ]
    },
    {
        "id": "07b2bd530ce25200",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "name": "Dist 2 Fan controller",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/Dist_2_FanController.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 1460,
        "y": 1800,
        "wires": [
            [
                "db5a25ff25f37f3e"
            ]
        ]
    },
    {
        "id": "db5a25ff25f37f3e",
        "type": "debug",
        "z": "84f9df6667326f98",
        "name": "debug 22",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1660,
        "y": 1800,
        "wires": []
    },
    {
        "id": "9bacb98be36f37dc",
        "type": "debug",
        "z": "84f9df6667326f98",
        "name": "Auto mode switch",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 290,
        "y": 3660,
        "wires": []
    },
    {
        "id": "564506cb197cc954",
        "type": "debug",
        "z": "84f9df6667326f98",
        "name": "Auto mode bool to str",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 3620,
        "wires": []
    },
    {
        "id": "57f723a2128c43d5",
        "type": "debug",
        "z": "84f9df6667326f98",
        "name": "Auto mode code",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 890,
        "y": 3620,
        "wires": []
    },
    {
        "id": "9a4c7a02cad47b84",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "Dist_1_EC_pH",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_1_EC_pH.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 320,
        "y": 680,
        "wires": [
            [
                "13c6bea38d428920"
            ]
        ]
    },
    {
        "id": "b221c02018673863",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "60",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 680,
        "wires": [
            [
                "9a4c7a02cad47b84"
            ]
        ]
    },
    {
        "id": "9a7f2b6b84f6a001",
        "type": "inject",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "Every 20 min",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "1200",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 120,
        "wires": [
            [
                "3a6b1b2c3d4e5f60"
            ]
        ]
    },
    {
        "id": "3a6b1b2c3d4e5f60",
        "type": "file in",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "Read CSV",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_1_EC_pH_log.csv",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": true,
        "encoding": "none",
        "allProps": false,
        "x": 330,
        "y": 120,
        "wires": [
            [
                "6f1e2d3c4b5a6978"
            ]
        ]
    },
    {
        "id": "6f1e2d3c4b5a6978",
        "type": "csv",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "CSV â†’ array",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 530,
        "y": 120,
        "wires": [
            [
                "fc506592c792073d"
            ]
        ]
    },
    {
        "id": "f5a4c3b2d1e0f999",
        "type": "function",
        "z": "c7d9c1b1f0a6a111",
        "d": true,
        "g": "be6e98c17615581b",
        "name": "Filter last 7 days + build chart points",
        "func": "// msg.payload = array of objects from CSV node\n// Header: Date,EC,pH,Solution_Temperature\n\nconst rows = Array.isArray(msg.payload) ? msg.payload : [];\nconst now = Date.now();\nconst cutoff = now - 7 * 24 * 60 * 60 * 1000; // last 7 days\n\nfunction toMs(dateStr){\n  if(!dateStr) return null;\n  const iso = String(dateStr).trim().replace(\" \", \"T\");\n  const t = new Date(iso).getTime();\n  return Number.isFinite(t) ? t : null;\n}\n\nfunction toNum(v){\n  const n = Number(String(v).trim());\n  return Number.isFinite(n) ? n : null;\n}\n\n// Build per-point messages (one msg per sample)\nconst outEC = [];\nconst outPH = [];\nconst outTP = [];\n\nfor(const r of rows){\n  const t = toMs(r.Date);\n  if(t === null || t < cutoff) continue;\n\n  const ec = toNum(r.EC);\n  const ph = toNum(r.pH);\n  const tp = toNum(r.Solution_Temperature);\n\n  if(ec !== null) outEC.push({ payload: ec, timestamp: t, topic: \"EC\" });\n  if(ph !== null) outPH.push({ payload: ph, timestamp: t, topic: \"pH\" });\n  if(tp !== null) outTP.push({ payload: tp, timestamp: t, topic: \"Solution_Temperature\" });\n}\n\n// Important: return arrays of messages (Node-RED will send them sequentially)\nreturn [outEC, outPH, outTP];",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 810,
        "y": 120,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "2c1d3e4f5a6b7c80",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "EC (last 7 days)",
        "group": "c5fb925fb5ca84e9",
        "order": 4,
        "width": 6,
        "height": 5,
        "label": "EC (dS/m)",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "No data",
        "dot": false,
        "ymin": "",
        "ymax": "3",
        "removeOlder": "7",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1280,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "3d2e4f5a6b7c8d90",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "pH (last 7 days)",
        "group": "c5fb925fb5ca84e9",
        "order": 5,
        "width": 6,
        "height": 5,
        "label": "pH",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "No data",
        "dot": false,
        "ymin": "1",
        "ymax": "10",
        "removeOlder": "7",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1300,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "4e3f5a6b7c8d9ea0",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "Solution Temp (last 7 days)",
        "group": "c5fb925fb5ca84e9",
        "order": 6,
        "width": 6,
        "height": 5,
        "label": "Solution Temperature (Â°C)",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "No data",
        "dot": false,
        "ymin": "10",
        "ymax": "50",
        "removeOlder": "7",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1300,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "10de8cbe4af04315",
        "type": "inject",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "Every 20 min",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "1200",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 380,
        "wires": [
            [
                "f1b1e91b834b1e7b"
            ]
        ]
    },
    {
        "id": "f1b1e91b834b1e7b",
        "type": "file in",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "Read CSV",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_2_EC_pH_log.csv",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": true,
        "encoding": "none",
        "allProps": false,
        "x": 310,
        "y": 380,
        "wires": [
            [
                "e6bfb513d88ab35f"
            ]
        ]
    },
    {
        "id": "e6bfb513d88ab35f",
        "type": "csv",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "CSV â†’ array",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 510,
        "y": 380,
        "wires": [
            [
                "66dddb17279fa4ea"
            ]
        ]
    },
    {
        "id": "0fe32ae7f7830fa0",
        "type": "function",
        "z": "c7d9c1b1f0a6a111",
        "d": true,
        "g": "7e05584f07adae7b",
        "name": "Filter last 7 days + build chart points",
        "func": "// msg.payload = array of objects from CSV node\n// Header: Date,EC,pH,Solution_Temperature\n\nconst rows = Array.isArray(msg.payload) ? msg.payload : [];\nconst now = Date.now();\nconst cutoff = now - 7 * 24 * 60 * 60 * 1000; // last 7 days\n\nfunction toMs(dateStr){\n  if(!dateStr) return null;\n  const iso = String(dateStr).trim().replace(\" \", \"T\");\n  const t = new Date(iso).getTime();\n  return Number.isFinite(t) ? t : null;\n}\n\nfunction toNum(v){\n  const n = Number(String(v).trim());\n  return Number.isFinite(n) ? n : null;\n}\n\n// Build per-point messages (one msg per sample)\nconst outEC = [];\nconst outPH = [];\nconst outTP = [];\n\nfor(const r of rows){\n  const t = toMs(r.Date);\n  if(t === null || t < cutoff) continue;\n\n  const ec = toNum(r.EC);\n  const ph = toNum(r.pH);\n  const tp = toNum(r.Solution_Temperature);\n\n  if(ec !== null) outEC.push({ payload: ec, timestamp: t, topic: \"EC\" });\n  if(ph !== null) outPH.push({ payload: ph, timestamp: t, topic: \"pH\" });\n  if(tp !== null) outTP.push({ payload: tp, timestamp: t, topic: \"Solution_Temperature\" });\n}\n\n// Important: return arrays of messages (Node-RED will send them sequentially)\nreturn [outEC, outPH, outTP];",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 790,
        "y": 380,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "84915ae7f5c9b3c6",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "EC (last 7 days)",
        "group": "aa578847983587e6",
        "order": 4,
        "width": 6,
        "height": 5,
        "label": "EC (dS/m)",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "No data",
        "dot": false,
        "ymin": "",
        "ymax": "3",
        "removeOlder": "7",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1280,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "7b2f5b8520aa74d8",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "pH (last 7 days)",
        "group": "aa578847983587e6",
        "order": 5,
        "width": 6,
        "height": 5,
        "label": "pH",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "No data",
        "dot": false,
        "ymin": "1",
        "ymax": "10",
        "removeOlder": "7",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1280,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "6104d3b154bae62a",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "Solution Temp (last 7 days)",
        "group": "aa578847983587e6",
        "order": 6,
        "width": 6,
        "height": 5,
        "label": "Solution Temperature (Â°C)",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "No data",
        "dot": false,
        "ymin": "10",
        "ymax": "50",
        "removeOlder": "7",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1300,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "11c49a6273f636d3",
        "type": "inject",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "Load CSV",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "1200",
        "crontab": "",
        "once": true,
        "onceDelay": 1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 680,
        "wires": [
            [
                "a2f36fd67d9dfe31"
            ]
        ]
    },
    {
        "id": "a2f36fd67d9dfe31",
        "type": "file in",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "Read Temp_humi_log.csv",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Temp_humi_log.csv",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": true,
        "encoding": "none",
        "allProps": false,
        "x": 360,
        "y": 680,
        "wires": [
            [
                "88a05da35409bfbf"
            ]
        ]
    },
    {
        "id": "efb0d37433575254",
        "type": "function",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "Filter last 7 days & split",
        "func": "// Comment: Build UI chart points safely (limit + downsample)\n// Input: msg.payload = array of objects from CSV node\n// Header: date,temperature,humidity,co2\n\nconst rows = Array.isArray(msg.payload) ? msg.payload : [];\n\n// === Config ===\nconst DAYS = 7;\nconst MAX_POINTS = 500;   // Max points per series to send to ui_chart\nconst DEBUG_LOG = false;  // trueë¡œ ë°”ê¾¸ë©´ ì¹´ìš´íŠ¸ ë¡œê·¸ ì¶œë ¥\n\nconst now = Date.now();\nconst cutoff = now - DAYS * 24 * 60 * 60 * 1000;\n\n// --- Helpers ---\nfunction toMs(dateStr) {\n  if (!dateStr) return null;\n  const s = String(dateStr).trim();\n  const iso = s.includes(\"T\") ? s : s.replace(\" \", \"T\");\n  const t = new Date(iso).getTime();\n  return Number.isFinite(t) ? t : null;\n}\n\nfunction toNum(v) {\n  if (v === undefined || v === null) return null;\n  const s = String(v).trim();\n  if (!s.length) return null;\n  const n = Number(s);\n  return Number.isFinite(n) ? n : null;\n}\n\nfunction sortByTimestamp(arr) {\n  arr.sort((a, b) => (a.timestamp || 0) - (b.timestamp || 0));\n  return arr;\n}\n\nfunction downsampleEvenly(arr, maxPoints) {\n  if (arr.length <= maxPoints) return arr;\n  const step = Math.ceil(arr.length / maxPoints);\n  const out = [];\n  for (let i = 0; i < arr.length; i += step) out.push(arr[i]);\n  return out;\n}\n\nfunction capAndDownsample(arr, maxPoints) {\n  if (arr.length <= maxPoints) return arr;\n  // ìµœì‹  ë°ì´í„° ìœ„ì£¼ë¡œ ì¡°ê¸ˆ ë„‰ë„‰ížˆ ìž¡ê³ (4ë°°) ê· ì¼ ë‹¤ìš´ìƒ˜í”Œ\n  const tail = arr.slice(-maxPoints * 4);\n  return downsampleEvenly(tail, maxPoints);\n}\n\n// --- Outputs ---\nconst outTemp = [];\nconst outHumi = [];\nconst outCO2 = [];\n\nfor (const r of rows) {\n  const t = toMs(r.date);\n  if (t === null || t < cutoff) continue;\n\n  const temp = toNum(r.temperature);\n  const humi = toNum(r.humidity);\n  const co2  = toNum(r.co2);\n\n  if (temp !== null) outTemp.push({ payload: temp, timestamp: t, topic: \"Temperature\" });\n  if (humi !== null) outHumi.push({ payload: humi, timestamp: t, topic: \"Humidity\" });\n  if (co2  !== null) outCO2.push({ payload: co2,  timestamp: t, topic: \"CO2\" });\n}\n\n// Sort then cap/downsample\nsortByTimestamp(outTemp);\nsortByTimestamp(outHumi);\nsortByTimestamp(outCO2);\n\nconst tempFinal = capAndDownsample(outTemp, MAX_POINTS);\nconst humiFinal = capAndDownsample(outHumi, MAX_POINTS);\nconst co2Final  = capAndDownsample(outCO2,  MAX_POINTS);\n\nif (DEBUG_LOG) {\n  node.warn({\n    rows: rows.length,\n    built: { temp: outTemp.length, humi: outHumi.length, co2: outCO2.length },\n    sent:  { temp: tempFinal.length, humi: humiFinal.length, co2: co2Final.length }\n  });\n}\n\n// Important: return arrays of messages\nreturn [tempFinal, humiFinal, co2Final];",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 840,
        "y": 680,
        "wires": [
            [
                "61d28f90c35a0e04"
            ],
            [
                "c3284b9db2edcac0"
            ],
            [
                "b4b069056ce7fe97"
            ]
        ]
    },
    {
        "id": "e7fd9e961e86b1b1",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "Temperature",
        "group": "c888f82b8cc4653a",
        "order": 4,
        "width": 6,
        "height": 5,
        "label": "Temperature (Â°C)",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 7,
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1290,
        "y": 640,
        "wires": [
            []
        ]
    },
    {
        "id": "9d672b31c0fdbdf0",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "Humidity",
        "group": "c888f82b8cc4653a",
        "order": 5,
        "width": 6,
        "height": 5,
        "label": "Humidity (%)",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "7",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": "",
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1300,
        "y": 700,
        "wires": [
            []
        ]
    },
    {
        "id": "74989654888b2172",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "CO2",
        "group": "c888f82b8cc4653a",
        "order": 6,
        "width": 6,
        "height": 5,
        "label": "CO2 (ppm)",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "300",
        "ymax": "",
        "removeOlder": "7",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": "",
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1290,
        "y": 760,
        "wires": [
            []
        ]
    },
    {
        "id": "88a05da35409bfbf",
        "type": "csv",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "CSV â†’ array",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 600,
        "y": 680,
        "wires": [
            [
                "efb0d37433575254"
            ]
        ]
    },
    {
        "id": "fc506592c792073d",
        "type": "function",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "Filter last 7 days + build chart points",
        "func": "// Comment: Build UI chart points safely (limit + downsample)\n// Input: msg.payload = array of objects from CSV node (hdrin:true)\n// Expected headers: Date, EC, pH, Solution_Temperature\n\nconst rows = Array.isArray(msg.payload) ? msg.payload : [];\n\n// === Config ===\nconst DAYS = 7;\nconst MAX_POINTS = 500;          // Max points per series to send to ui_chart\nconst DEBUG_LOG = true;          // Set false to silence node.warn logs\nconst REQUIRE_HEADERS = false;   // If true, skip rows missing Date\n\nconst now = Date.now();\nconst cutoff = now - DAYS * 24 * 60 * 60 * 1000;\n\n// --- Helpers ---\nfunction toMs(dateStr) {\n  if (!dateStr) return null;\n\n  // Accept \"YYYY-MM-DD HH:MM:SS\" or ISO\n  const s = String(dateStr).trim();\n\n  // If it already contains 'T', keep it. Otherwise replace first space with 'T'\n  const iso = s.includes(\"T\") ? s : s.replace(\" \", \"T\");\n\n  const t = new Date(iso).getTime();\n  return Number.isFinite(t) ? t : null;\n}\n\nfunction toNum(v) {\n  if (v === null || v === undefined) return null;\n  const s = String(v).trim();\n  if (!s.length) return null;\n  const n = Number(s);\n  return Number.isFinite(n) ? n : null;\n}\n\nfunction sortByTimestamp(arr) {\n  // Ensure chart draws in time order\n  arr.sort((a, b) => (a.timestamp || 0) - (b.timestamp || 0));\n  return arr;\n}\n\nfunction downsampleEvenly(arr, maxPoints) {\n  if (arr.length <= maxPoints) return arr;\n  const step = Math.ceil(arr.length / maxPoints);\n  const out = [];\n  for (let i = 0; i < arr.length; i += step) out.push(arr[i]);\n  return out;\n}\n\nfunction capAndDownsample(arr, maxPoints) {\n  // Keep most recent points, then downsample evenly if still too many\n  if (arr.length <= maxPoints) return arr;\n  const tail = arr.slice(-maxPoints * 4); // keep a bigger tail before downsample\n  return downsampleEvenly(tail, maxPoints);\n}\n\nfunction maxPayloadStrLen(arr) {\n  // For debugging: what's the longest payload string length?\n  let m = 0;\n  for (const p of arr) {\n    const s = String(p.payload);\n    if (s.length > m) m = s.length;\n  }\n  return m;\n}\n\n// --- Build messages ---\nconst outEC = [];\nconst outPH = [];\nconst outTP = [];\n\nfor (const r of rows) {\n  const t = toMs(r.Date);\n\n  if (t === null) {\n    if (REQUIRE_HEADERS) continue;\n    // If Date is invalid, skip safely\n    continue;\n  }\n  if (t < cutoff) continue;\n\n  const ec = toNum(r.EC);\n  const ph = toNum(r.pH);\n  const tp = toNum(r.Solution_Temperature);\n\n  if (ec !== null) outEC.push({ payload: ec, timestamp: t, topic: \"EC\" });\n  if (ph !== null) outPH.push({ payload: ph, timestamp: t, topic: \"pH\" });\n  if (tp !== null) outTP.push({ payload: tp, timestamp: t, topic: \"Solution_Temperature\" });\n}\n\n// Sort then cap/downsample (important if file isn't strictly chronological)\nsortByTimestamp(outEC);\nsortByTimestamp(outPH);\nsortByTimestamp(outTP);\n\nconst ecFinal = capAndDownsample(outEC, MAX_POINTS);\nconst phFinal = capAndDownsample(outPH, MAX_POINTS);\nconst tpFinal = capAndDownsample(outTP, MAX_POINTS);\n\n// --- Debug info (helps identify \"message flood\" vs \"huge payload\") ---\nif (DEBUG_LOG) {\n  node.warn({\n    rows: rows.length,\n    cutoffISO: new Date(cutoff).toISOString(),\n    built: { EC: outEC.length, pH: outPH.length, TP: outTP.length },\n    sent: { EC: ecFinal.length, pH: phFinal.length, TP: tpFinal.length },\n    maxPayloadLen: {\n      EC: maxPayloadStrLen(ecFinal),\n      pH: maxPayloadStrLen(phFinal),\n      TP: maxPayloadStrLen(tpFinal)\n    }\n  });\n}\n\n// Return arrays of messages (Node-RED will send them sequentially)\nreturn [ecFinal, phFinal, tpFinal];",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 810,
        "y": 180,
        "wires": [
            [
                "2b11787c0f4b97a0"
            ],
            [
                "fcc61e3763443285"
            ],
            [
                "9e58a61289d8c37b"
            ]
        ]
    },
    {
        "id": "66dddb17279fa4ea",
        "type": "function",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "Filter last 7 days + build chart points",
        "func": "// Comment: Build UI chart points safely (limit + downsample)\n// Input: msg.payload = array of objects from CSV node (hdrin:true)\n// Expected headers: Date, EC, pH, Solution_Temperature\n\nconst rows = Array.isArray(msg.payload) ? msg.payload : [];\n\n// === Config ===\nconst DAYS = 7;\nconst MAX_POINTS = 500;          // Max points per series to send to ui_chart\nconst DEBUG_LOG = true;          // Set false to silence node.warn logs\nconst REQUIRE_HEADERS = false;   // If true, skip rows missing Date\n\nconst now = Date.now();\nconst cutoff = now - DAYS * 24 * 60 * 60 * 1000;\n\n// --- Helpers ---\nfunction toMs(dateStr) {\n  if (!dateStr) return null;\n\n  // Accept \"YYYY-MM-DD HH:MM:SS\" or ISO\n  const s = String(dateStr).trim();\n\n  // If it already contains 'T', keep it. Otherwise replace first space with 'T'\n  const iso = s.includes(\"T\") ? s : s.replace(\" \", \"T\");\n\n  const t = new Date(iso).getTime();\n  return Number.isFinite(t) ? t : null;\n}\n\nfunction toNum(v) {\n  if (v === null || v === undefined) return null;\n  const s = String(v).trim();\n  if (!s.length) return null;\n  const n = Number(s);\n  return Number.isFinite(n) ? n : null;\n}\n\nfunction sortByTimestamp(arr) {\n  // Ensure chart draws in time order\n  arr.sort((a, b) => (a.timestamp || 0) - (b.timestamp || 0));\n  return arr;\n}\n\nfunction downsampleEvenly(arr, maxPoints) {\n  if (arr.length <= maxPoints) return arr;\n  const step = Math.ceil(arr.length / maxPoints);\n  const out = [];\n  for (let i = 0; i < arr.length; i += step) out.push(arr[i]);\n  return out;\n}\n\nfunction capAndDownsample(arr, maxPoints) {\n  // Keep most recent points, then downsample evenly if still too many\n  if (arr.length <= maxPoints) return arr;\n  const tail = arr.slice(-maxPoints * 4); // keep a bigger tail before downsample\n  return downsampleEvenly(tail, maxPoints);\n}\n\nfunction maxPayloadStrLen(arr) {\n  // For debugging: what's the longest payload string length?\n  let m = 0;\n  for (const p of arr) {\n    const s = String(p.payload);\n    if (s.length > m) m = s.length;\n  }\n  return m;\n}\n\n// --- Build messages ---\nconst outEC = [];\nconst outPH = [];\nconst outTP = [];\n\nfor (const r of rows) {\n  const t = toMs(r.Date);\n\n  if (t === null) {\n    if (REQUIRE_HEADERS) continue;\n    // If Date is invalid, skip safely\n    continue;\n  }\n  if (t < cutoff) continue;\n\n  const ec = toNum(r.EC);\n  const ph = toNum(r.pH);\n  const tp = toNum(r.Solution_Temperature);\n\n  if (ec !== null) outEC.push({ payload: ec, timestamp: t, topic: \"EC\" });\n  if (ph !== null) outPH.push({ payload: ph, timestamp: t, topic: \"pH\" });\n  if (tp !== null) outTP.push({ payload: tp, timestamp: t, topic: \"Solution_Temperature\" });\n}\n\n// Sort then cap/downsample (important if file isn't strictly chronological)\nsortByTimestamp(outEC);\nsortByTimestamp(outPH);\nsortByTimestamp(outTP);\n\nconst ecFinal = capAndDownsample(outEC, MAX_POINTS);\nconst phFinal = capAndDownsample(outPH, MAX_POINTS);\nconst tpFinal = capAndDownsample(outTP, MAX_POINTS);\n\n// --- Debug info (helps identify \"message flood\" vs \"huge payload\") ---\nif (DEBUG_LOG) {\n  node.warn({\n    rows: rows.length,\n    cutoffISO: new Date(cutoff).toISOString(),\n    built: { EC: outEC.length, pH: outPH.length, TP: outTP.length },\n    sent: { EC: ecFinal.length, pH: phFinal.length, TP: tpFinal.length },\n    maxPayloadLen: {\n      EC: maxPayloadStrLen(ecFinal),\n      pH: maxPayloadStrLen(phFinal),\n      TP: maxPayloadStrLen(tpFinal)\n    }\n  });\n}\n\n// Return arrays of messages (Node-RED will send them sequentially)\nreturn [ecFinal, phFinal, tpFinal];",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 790,
        "y": 440,
        "wires": [
            [
                "2ca82c801cc78dcf"
            ],
            [
                "7bcaa443ae916920"
            ],
            [
                "c17e5970c5cc707c"
            ]
        ]
    },
    {
        "id": "2b11787c0f4b97a0",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "20",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1100,
        "y": 100,
        "wires": [
            [
                "2c1d3e4f5a6b7c80"
            ]
        ]
    },
    {
        "id": "fcc61e3763443285",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "20",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1100,
        "y": 160,
        "wires": [
            [
                "3d2e4f5a6b7c8d90"
            ]
        ]
    },
    {
        "id": "9e58a61289d8c37b",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "20",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1080,
        "y": 220,
        "wires": [
            [
                "4e3f5a6b7c8d9ea0"
            ]
        ]
    },
    {
        "id": "2ca82c801cc78dcf",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "20",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1080,
        "y": 380,
        "wires": [
            [
                "84915ae7f5c9b3c6"
            ]
        ]
    },
    {
        "id": "7bcaa443ae916920",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "20",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1080,
        "y": 440,
        "wires": [
            [
                "7b2f5b8520aa74d8"
            ]
        ]
    },
    {
        "id": "c17e5970c5cc707c",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "20",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1060,
        "y": 480,
        "wires": [
            [
                "6104d3b154bae62a"
            ]
        ]
    },
    {
        "id": "61d28f90c35a0e04",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "20",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1080,
        "y": 640,
        "wires": [
            [
                "e7fd9e961e86b1b1"
            ]
        ]
    },
    {
        "id": "c3284b9db2edcac0",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "20",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1080,
        "y": 680,
        "wires": [
            [
                "9d672b31c0fdbdf0"
            ]
        ]
    },
    {
        "id": "b4b069056ce7fe97",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "20",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1080,
        "y": 740,
        "wires": [
            [
                "74989654888b2172"
            ]
        ]
    },
    {
        "id": "inject_10min",
        "type": "inject",
        "z": "flow_all",
        "g": "e74e46c298b7c6cb",
        "name": "Auto Refresh 10min",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "600",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "x": 190,
        "y": 120,
        "wires": [
            [
                "table_read_file"
            ]
        ]
    },
    {
        "id": "uib_refresh",
        "type": "ui_button",
        "z": "flow_all",
        "g": "e74e46c298b7c6cb",
        "name": "Manual Refresh",
        "group": "ui_grp_table",
        "order": 2,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "Data Refresh",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 210,
        "y": 180,
        "wires": [
            [
                "table_read_file"
            ]
        ]
    },
    {
        "id": "tmpl_download",
        "type": "ui_template",
        "z": "flow_all",
        "g": "e74e46c298b7c6cb",
        "group": "ui_grp_table",
        "name": "Download CSV Button",
        "order": 3,
        "width": 3,
        "height": 1,
        "format": "<a class=\"md-button md-raised md-primary\" style=\"width:100%;height:100%;display:flex;align-items:center;justify-content:center;\" href=\"/download_csv\" target=\"_self\">CSV Download</a>",
        "storeOutMessages": false,
        "fwdInMessages": false,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 240,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "table_read_file",
        "type": "file in",
        "z": "flow_all",
        "g": "e74e46c298b7c6cb",
        "name": "Read CSV File",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Temp_humi_log.csv",
        "filenameType": "str",
        "format": "utf8",
        "sendError": true,
        "allProps": false,
        "x": 450,
        "y": 150,
        "wires": [
            [
                "734f54c626594136"
            ]
        ]
    },
    {
        "id": "csv_to_json",
        "type": "csv",
        "z": "flow_all",
        "g": "e74e46c298b7c6cb",
        "name": "CSV to JSON",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "mult",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 680,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "table_ui",
        "type": "ui_table",
        "z": "flow_all",
        "g": "e74e46c298b7c6cb",
        "group": "ui_grp_table",
        "name": "Temp/Humi Table",
        "order": 1,
        "width": 6,
        "height": 10,
        "columns": [],
        "outputs": 1,
        "cts": true,
        "x": 890,
        "y": 150,
        "wires": [
            []
        ]
    },
    {
        "id": "http_in_download",
        "type": "http in",
        "z": "flow_all",
        "g": "e74e46c298b7c6cb",
        "name": "GET /download_csv",
        "url": "/download_csv",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 170,
        "y": 320,
        "wires": [
            [
                "read_file_download"
            ]
        ]
    },
    {
        "id": "read_file_download",
        "type": "file in",
        "z": "flow_all",
        "g": "e74e46c298b7c6cb",
        "name": "Read CSV (binary)",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Temp_humi_log.csv",
        "format": "binary",
        "sendError": true,
        "x": 420,
        "y": 320,
        "wires": [
            [
                "http_response_download"
            ]
        ]
    },
    {
        "id": "http_response_download",
        "type": "http response",
        "z": "flow_all",
        "g": "e74e46c298b7c6cb",
        "name": "Send CSV",
        "statusCode": "",
        "headers": {
            "Content-Type": "text/csv; charset=utf-8",
            "Content-Disposition": "attachment; filename=Temp_humi_log.csv"
        },
        "x": 640,
        "y": 320,
        "wires": []
    },
    {
        "id": "eccd6ca216a8ac97",
        "type": "comment",
        "z": "flow_all",
        "g": "e74e46c298b7c6cb",
        "name": "(W)Read Temp&Humi log csv file and show to the table on dashboard",
        "info": "",
        "x": 310,
        "y": 60,
        "wires": []
    },
    {
        "id": "c6456d1672233c77",
        "type": "inject",
        "z": "flow_all",
        "g": "9b29f194d8a3aae8",
        "name": "í‘œ ìžë™ ìƒˆë¡œê³ ì¹¨ (10ë¶„)",
        "props": [
            {
                "p": "filename",
                "v": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_1_EC_pH_log.csv",
                "vt": "str"
            }
        ],
        "repeat": "600",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "x": 170,
        "y": 500,
        "wires": [
            [
                "888936cb5be63657"
            ]
        ]
    },
    {
        "id": "9bb8aa797d2db538",
        "type": "ui_button",
        "z": "flow_all",
        "g": "9b29f194d8a3aae8",
        "name": "Manual Refresh",
        "group": "grp_dl",
        "order": 2,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "Data Refresh",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 200,
        "y": 560,
        "wires": [
            [
                "6fd08ead6c34727b"
            ]
        ]
    },
    {
        "id": "6fd08ead6c34727b",
        "type": "function",
        "z": "flow_all",
        "g": "9b29f194d8a3aae8",
        "name": "íŒŒì¼ê²½ë¡œ ì„¸íŒ…",
        "func": "msg.filename = \"/home/cja/Work/cja-skyfarms-project/sensors/Dist_1_EC_pH_log.csv\";\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 440,
        "y": 560,
        "wires": [
            [
                "888936cb5be63657"
            ]
        ]
    },
    {
        "id": "888936cb5be63657",
        "type": "file in",
        "z": "flow_all",
        "g": "9b29f194d8a3aae8",
        "name": "Read Dist_1_EC_pH_log.csv (utf8)",
        "filename": "filename",
        "filenameType": "msg",
        "format": "utf8",
        "sendError": true,
        "allProps": false,
        "x": 480,
        "y": 500,
        "wires": [
            [
                "7d38609966719e04"
            ]
        ]
    },
    {
        "id": "7d38609966719e04",
        "type": "function",
        "z": "flow_all",
        "g": "9b29f194d8a3aae8",
        "name": "CSV â†’ rows[]",
        "func": "// Comment: CSV text -> rows[] for ui_table (EC/pH/Temp)\n\nconst text = (msg.payload || \"\").toString();\nif (!text.trim()) { msg.payload = []; return msg; }\n\nconst lines = text.replace(/\\r\\n?/g, \"\\n\").split(\"\\n\").filter(l => l.trim().length);\nif (lines.length === 0) { msg.payload = []; return msg; }\n\nconst first = lines[0].trim().toLowerCase();\nlet header;\n\nif (first.startsWith(\"date\") || first.startsWith(\"timestamp\")) {\n  header = lines[0].split(\",\").map(h => h.trim());\n  lines.shift();\n} else {\n  header = [\"Date\", \"EC\", \"pH\", \"Solution_Temperature\"];\n}\n\nfunction toNumOrNull(v) {\n  const s = String(v ?? \"\").trim();\n  if (!s) return null;\n  const n = Number(s);\n  return Number.isFinite(n) ? n : null;\n}\n\nconst rows = [];\nfor (const line of lines) {\n  const cols = line.split(\",\");\n  if (cols.length < 4) continue;\n\n  rows.push({\n    [header[0]]: cols[0].trim(),\n    [header[1]]: toNumOrNull(cols[1]),\n    [header[2]]: toNumOrNull(cols[2]),\n    [header[3]]: toNumOrNull(cols[3]),\n  });\n}\n\nmsg.payload = rows.slice(-300);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 500,
        "wires": [
            [
                "ee81447397a9b21c"
            ]
        ]
    },
    {
        "id": "ee81447397a9b21c",
        "type": "ui_table",
        "z": "flow_all",
        "g": "9b29f194d8a3aae8",
        "group": "grp_dl",
        "name": "EC/pH Table",
        "order": 1,
        "width": 6,
        "height": 10,
        "columns": [],
        "outputs": 1,
        "cts": true,
        "x": 930,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "d68f35126f715e09",
        "type": "ui_template",
        "z": "flow_all",
        "g": "9b29f194d8a3aae8",
        "group": "grp_dl",
        "name": "Download CSV Button",
        "order": 3,
        "width": 3,
        "height": 1,
        "format": "<a class=\"md-button md-raised md-primary\" style=\"width:100%;height:100%;display:flex;align-items:center;justify-content:center;\" href=\"/download_ecph_dist1\" target=\"_self\">CSV Download</a>",
        "storeOutMessages": false,
        "fwdInMessages": false,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 180,
        "y": 640,
        "wires": [
            []
        ]
    },
    {
        "id": "e3164829ad2f9c99",
        "type": "http in",
        "z": "flow_all",
        "g": "9b29f194d8a3aae8",
        "name": "GET /download_ecph_dist1",
        "url": "/download_ecph_dist1",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 190,
        "y": 700,
        "wires": [
            [
                "d7ba64a61cb93a1c"
            ]
        ]
    },
    {
        "id": "d7ba64a61cb93a1c",
        "type": "file in",
        "z": "flow_all",
        "g": "9b29f194d8a3aae8",
        "name": "Read CSV (binary)",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_1_EC_pH_log.csv",
        "filenameType": "str",
        "format": "binary",
        "sendError": true,
        "allProps": false,
        "x": 430,
        "y": 700,
        "wires": [
            [
                "bd6f7ce9ccfb1bf7"
            ]
        ]
    },
    {
        "id": "bd6f7ce9ccfb1bf7",
        "type": "http response",
        "z": "flow_all",
        "g": "9b29f194d8a3aae8",
        "name": "Send CSV",
        "statusCode": "",
        "headers": {
            "Content-Type": "text/csv; charset=utf-8",
            "Content-Disposition": "attachment; filename=Dist_1_EC_pH_log.csv"
        },
        "x": 650,
        "y": 700,
        "wires": []
    },
    {
        "id": "2205b965641cc936",
        "type": "comment",
        "z": "flow_all",
        "g": "9b29f194d8a3aae8",
        "name": "(W)Read EC&pH log csv file and show to the table on dashboard",
        "info": "",
        "x": 270,
        "y": 440,
        "wires": []
    },
    {
        "id": "459214eb53b8201a",
        "type": "inject",
        "z": "flow_all",
        "g": "d0f7352041fbc952",
        "name": "í‘œ ìžë™ ìƒˆë¡œê³ ì¹¨ (10ë¶„)",
        "props": [
            {
                "p": "filename",
                "v": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_1_Solution_input_log.csv",
                "vt": "str"
            }
        ],
        "repeat": "600",
        "crontab": "",
        "once": true,
        "onceDelay": "3",
        "topic": "",
        "x": 160,
        "y": 900,
        "wires": [
            [
                "c1c5d1be217dd1ca"
            ]
        ]
    },
    {
        "id": "f57f70b40106ba3b",
        "type": "ui_button",
        "z": "flow_all",
        "g": "d0f7352041fbc952",
        "name": "Manual Refresh",
        "group": "0c96d57341bb54fa",
        "order": 2,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "Data Refresh",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 190,
        "y": 960,
        "wires": [
            [
                "ae6fd6772d53e43a"
            ]
        ]
    },
    {
        "id": "ae6fd6772d53e43a",
        "type": "function",
        "z": "flow_all",
        "g": "d0f7352041fbc952",
        "name": "íŒŒì¼ê²½ë¡œ ì„¸íŒ…",
        "func": "msg.filename = \"/home/cja/Work/cja-skyfarms-project/sensors/Dist_1_Solution_input_log.csv\";\nreturn msg;\n\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 960,
        "wires": [
            [
                "c1c5d1be217dd1ca"
            ]
        ]
    },
    {
        "id": "c1c5d1be217dd1ca",
        "type": "file in",
        "z": "flow_all",
        "g": "d0f7352041fbc952",
        "name": "Read Dist_1_Solution_input_log.csv (utf8)",
        "filename": "filename",
        "filenameType": "msg",
        "format": "utf8",
        "sendError": true,
        "allProps": false,
        "x": 480,
        "y": 900,
        "wires": [
            [
                "74fee1ff15336b2e"
            ]
        ]
    },
    {
        "id": "74fee1ff15336b2e",
        "type": "function",
        "z": "flow_all",
        "g": "d0f7352041fbc952",
        "name": "CSV â†’ rows[]",
        "func": "// Comment: CSV text -> rows[] for ui_table (Solution input logs)\n// Keep everything as string\n\nconst text = (msg.payload || \"\").toString();\nif (!text.trim()) { msg.payload = []; return msg; }\n\nconst lines = text.replace(/\\r\\n?/g, \"\\n\").split(\"\\n\").filter(l => l.trim().length);\nif (lines.length === 0) { msg.payload = []; return msg; }\n\nconst first = lines[0].trim().toLowerCase();\nlet header;\n\nif (first.startsWith(\"timestamp\") || first.startsWith(\"date\")) {\n  header = lines[0].split(\",\").map(h => h.trim());\n  lines.shift();\n} else {\n  header = [\"timestamp\", \"device\", \"action\", \"detail\", \"duration\", \"etc\"];\n  // ë§Œì•½ ë„¤ íŒŒì¼ í—¤ë”ê°€ ê³ ì •ì´ë¼ë©´ ìœ„ë¥¼ ì‹¤ì œ í—¤ë”ì— ë§žì¶° ìˆ˜ì •\n}\n\nconst rows = [];\nfor (const line of lines) {\n  const cols = line.split(\",\");\n  if (cols.length < 2) continue;\n\n  const obj = {};\n  for (let i = 0; i < Math.min(cols.length, header.length); i++) {\n    obj[header[i]] = cols[i].trim();\n  }\n  rows.push(obj);\n}\n\nmsg.payload = rows.slice(-200);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 900,
        "wires": [
            [
                "2923571850219960"
            ]
        ]
    },
    {
        "id": "2923571850219960",
        "type": "ui_table",
        "z": "flow_all",
        "g": "d0f7352041fbc952",
        "group": "0c96d57341bb54fa",
        "name": "Solution input Table",
        "order": 1,
        "width": 6,
        "height": 10,
        "columns": [],
        "outputs": 1,
        "cts": true,
        "x": 940,
        "y": 900,
        "wires": [
            []
        ]
    },
    {
        "id": "e9b78c33d6da39ab",
        "type": "ui_template",
        "z": "flow_all",
        "g": "d0f7352041fbc952",
        "group": "0c96d57341bb54fa",
        "name": "Download CSV Button",
        "order": 3,
        "width": 3,
        "height": 1,
        "format": "<a class=\"md-button md-raised md-primary\" style=\"width:100%;height:100%;display:flex;align-items:center;justify-content:center;\" href=\"/download_solution_dist1\" target=\"_self\">CSV Download</a>",
        "storeOutMessages": false,
        "fwdInMessages": false,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 170,
        "y": 1040,
        "wires": [
            []
        ]
    },
    {
        "id": "1d899e847958cc51",
        "type": "http in",
        "z": "flow_all",
        "g": "d0f7352041fbc952",
        "name": "GET /download_solution_dist1",
        "url": "/download_solution_dist1",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 190,
        "y": 1100,
        "wires": [
            [
                "762997c612a3239b"
            ]
        ]
    },
    {
        "id": "762997c612a3239b",
        "type": "file in",
        "z": "flow_all",
        "g": "d0f7352041fbc952",
        "name": "Read CSV (binary)",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_1_Solution_input_log.csv",
        "filenameType": "str",
        "format": "binary",
        "sendError": true,
        "allProps": false,
        "x": 450,
        "y": 1100,
        "wires": [
            [
                "d62e857fdfc39204"
            ]
        ]
    },
    {
        "id": "d62e857fdfc39204",
        "type": "http response",
        "z": "flow_all",
        "g": "d0f7352041fbc952",
        "name": "Send CSV",
        "statusCode": "",
        "headers": {
            "Content-Type": "text/csv; charset=utf-8",
            "Content-Disposition": "attachment; filename=Dist_1_Solution_input_log.csv"
        },
        "x": 640,
        "y": 1100,
        "wires": []
    },
    {
        "id": "64e0010d99179742",
        "type": "comment",
        "z": "flow_all",
        "g": "d0f7352041fbc952",
        "name": "(W)Read Solution A/B/Acid log CSV and show/download",
        "info": "",
        "x": 330,
        "y": 840,
        "wires": []
    },
    {
        "id": "734f54c626594136",
        "type": "function",
        "z": "flow_all",
        "g": "e74e46c298b7c6cb",
        "name": "CSV â†’ rows[]",
        "func": "const text = (msg.payload||'').toString();\nif(!text.trim()) { msg.payload = []; return msg; }\nconst lines = text.replace(/\\r\\n?/g,'\\n').split('\\n').filter(l=>l.trim().length);\nlet header = [];\nif(lines[0].toLowerCase().startsWith('timestamp')){\n  header = lines[0].split(',').map(h=>h.trim());\n  lines.shift();\n} else {\n  header = ['Date','Temperature','Humidity','CO2'];\n}\nconst rows = [];\nfor(const line of lines){\n  const cols = line.split(',');\n  if(cols.length < 3) continue;\n  rows.push({\n    [header[0]]: cols[0].trim(),\n    [header[1]]: Number(cols[1]),\n    [header[2]]: Number(cols[2]),\n    [header[3]]: Number(cols[3])\n  });\n}\nmsg.payload = rows.slice(-500);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 660,
        "y": 140,
        "wires": [
            [
                "table_ui"
            ]
        ]
    },
    {
        "id": "27fc66eaaca23794",
        "type": "inject",
        "z": "flow_all",
        "g": "c62aa2d73263b188",
        "name": "í‘œ ìžë™ ìƒˆë¡œê³ ì¹¨ (10ë¶„)",
        "props": [
            {
                "p": "filename",
                "v": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_2_EC_pH_log.csv",
                "vt": "str"
            }
        ],
        "repeat": "600",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "x": 1270,
        "y": 520,
        "wires": [
            [
                "3f0ad1a72df8b757"
            ]
        ]
    },
    {
        "id": "61caf0db18f2428d",
        "type": "ui_button",
        "z": "flow_all",
        "g": "c62aa2d73263b188",
        "name": "Manual Refresh",
        "group": "96111742475c44e1",
        "order": 2,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "Data Refresh",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 1300,
        "y": 580,
        "wires": [
            [
                "c09b25e4d365be34"
            ]
        ]
    },
    {
        "id": "c09b25e4d365be34",
        "type": "function",
        "z": "flow_all",
        "g": "c62aa2d73263b188",
        "name": "íŒŒì¼ê²½ë¡œ ì„¸íŒ…",
        "func": "msg.filename = \"/home/cja/Work/cja-skyfarms-project/sensors/Dist_2_EC_pH_log.csv\";\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1540,
        "y": 580,
        "wires": [
            [
                "3f0ad1a72df8b757"
            ]
        ]
    },
    {
        "id": "3f0ad1a72df8b757",
        "type": "file in",
        "z": "flow_all",
        "g": "c62aa2d73263b188",
        "name": "Read Dist_2_EC_pH_log.csv (utf8)",
        "filename": "filename",
        "filenameType": "msg",
        "format": "utf8",
        "sendError": true,
        "allProps": false,
        "x": 1580,
        "y": 520,
        "wires": [
            [
                "5a814c3c8a19e0be"
            ]
        ]
    },
    {
        "id": "5a814c3c8a19e0be",
        "type": "function",
        "z": "flow_all",
        "g": "c62aa2d73263b188",
        "name": "CSV â†’ rows[]",
        "func": "// Comment: CSV text -> rows[] for ui_table (EC/pH/Temp)\n\nconst text = (msg.payload || \"\").toString();\nif (!text.trim()) { msg.payload = []; return msg; }\n\nconst lines = text.replace(/\\r\\n?/g, \"\\n\").split(\"\\n\").filter(l => l.trim().length);\nif (lines.length === 0) { msg.payload = []; return msg; }\n\nconst first = lines[0].trim().toLowerCase();\nlet header;\n\nif (first.startsWith(\"date\") || first.startsWith(\"timestamp\")) {\n  header = lines[0].split(\",\").map(h => h.trim());\n  lines.shift();\n} else {\n  header = [\"Date\", \"EC\", \"pH\", \"Solution_Temperature\"];\n}\n\nfunction toNumOrNull(v) {\n  const s = String(v ?? \"\").trim();\n  if (!s) return null;\n  const n = Number(s);\n  return Number.isFinite(n) ? n : null;\n}\n\nconst rows = [];\nfor (const line of lines) {\n  const cols = line.split(\",\");\n  if (cols.length < 4) continue;\n\n  rows.push({\n    [header[0]]: cols[0].trim(),\n    [header[1]]: toNumOrNull(cols[1]),\n    [header[2]]: toNumOrNull(cols[2]),\n    [header[3]]: toNumOrNull(cols[3]),\n  });\n}\n\nmsg.payload = rows.slice(-300);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1840,
        "y": 520,
        "wires": [
            [
                "1ba33261f437d902"
            ]
        ]
    },
    {
        "id": "1ba33261f437d902",
        "type": "ui_table",
        "z": "flow_all",
        "g": "c62aa2d73263b188",
        "group": "96111742475c44e1",
        "name": "EC/pH Table",
        "order": 1,
        "width": 6,
        "height": 10,
        "columns": [],
        "outputs": 1,
        "cts": true,
        "x": 2030,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "36344a406840362d",
        "type": "ui_template",
        "z": "flow_all",
        "g": "c62aa2d73263b188",
        "group": "96111742475c44e1",
        "name": "Download CSV Button",
        "order": 3,
        "width": 3,
        "height": 1,
        "format": "<a class=\"md-button md-raised md-primary\" style=\"width:100%;height:100%;display:flex;align-items:center;justify-content:center;\" href=\"/download_ecph_dist2\" target=\"_self\">CSV Download</a>",
        "storeOutMessages": false,
        "fwdInMessages": false,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 1280,
        "y": 660,
        "wires": [
            []
        ]
    },
    {
        "id": "b2a258edcf5a958e",
        "type": "http in",
        "z": "flow_all",
        "g": "c62aa2d73263b188",
        "name": "GET /download_ecph_dist2",
        "url": "/download_ecph_dist2",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 1290,
        "y": 720,
        "wires": [
            [
                "9e97d9f96995bf28"
            ]
        ]
    },
    {
        "id": "9e97d9f96995bf28",
        "type": "file in",
        "z": "flow_all",
        "g": "c62aa2d73263b188",
        "name": "Read CSV (binary)",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_2_EC_pH_log.csv",
        "filenameType": "str",
        "format": "binary",
        "sendError": true,
        "allProps": false,
        "x": 1530,
        "y": 720,
        "wires": [
            [
                "0be035f89455a795"
            ]
        ]
    },
    {
        "id": "0be035f89455a795",
        "type": "http response",
        "z": "flow_all",
        "g": "c62aa2d73263b188",
        "name": "Send CSV",
        "statusCode": "",
        "headers": {
            "Content-Type": "text/csv; charset=utf-8",
            "Content-Disposition": "attachment; filename=Dist_2_EC_pH_log.csv"
        },
        "x": 1750,
        "y": 720,
        "wires": []
    },
    {
        "id": "4d55c4ca6af1390e",
        "type": "comment",
        "z": "flow_all",
        "g": "c62aa2d73263b188",
        "name": "(W)Read EC&pH log csv file and show to the table on dashboard",
        "info": "",
        "x": 1370,
        "y": 460,
        "wires": []
    },
    {
        "id": "e7891915e633acd2",
        "type": "inject",
        "z": "flow_all",
        "g": "be44b588c52432ea",
        "name": "í‘œ ìžë™ ìƒˆë¡œê³ ì¹¨ (10ë¶„)",
        "props": [
            {
                "p": "filename",
                "v": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_2_Solution_input_log.csv",
                "vt": "str"
            }
        ],
        "repeat": "600",
        "crontab": "",
        "once": true,
        "onceDelay": "9",
        "topic": "",
        "x": 1260,
        "y": 920,
        "wires": [
            [
                "51704d967a421a19"
            ]
        ]
    },
    {
        "id": "a6223c1af0cd3dd5",
        "type": "ui_button",
        "z": "flow_all",
        "g": "be44b588c52432ea",
        "name": "Manual Refresh",
        "group": "1b4aaf5eb31383f2",
        "order": 2,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "Data Refresh",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 1220,
        "y": 980,
        "wires": [
            [
                "8d665aadf1c7067c"
            ]
        ]
    },
    {
        "id": "8d665aadf1c7067c",
        "type": "function",
        "z": "flow_all",
        "g": "be44b588c52432ea",
        "name": "íŒŒì¼ê²½ë¡œ ì„¸íŒ…",
        "func": "msg.filename = \"/home/cja/Work/cja-skyfarms-project/sensors/Dist_2_Solution_input_log.csv\";\nreturn msg;\n\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1450,
        "y": 980,
        "wires": [
            [
                "51704d967a421a19"
            ]
        ]
    },
    {
        "id": "51704d967a421a19",
        "type": "file in",
        "z": "flow_all",
        "g": "be44b588c52432ea",
        "name": "Read Dist_2_Solution_input_log.csv (utf8)",
        "filename": "filename",
        "filenameType": "msg",
        "format": "utf8",
        "sendError": true,
        "encoding": "none",
        "allProps": false,
        "x": 1590,
        "y": 920,
        "wires": [
            [
                "01e0b9d102a39fd5"
            ]
        ]
    },
    {
        "id": "01e0b9d102a39fd5",
        "type": "function",
        "z": "flow_all",
        "g": "be44b588c52432ea",
        "name": "CSV â†’ rows[]",
        "func": "// Comment: CSV text -> rows[] for ui_table (Solution input logs)\n// Keep everything as string\n\nconst text = (msg.payload || \"\").toString();\nif (!text.trim()) { msg.payload = []; return msg; }\n\nconst lines = text.replace(/\\r\\n?/g, \"\\n\").split(\"\\n\").filter(l => l.trim().length);\nif (lines.length === 0) { msg.payload = []; return msg; }\n\nconst first = lines[0].trim().toLowerCase();\nlet header;\n\nif (first.startsWith(\"timestamp\") || first.startsWith(\"date\")) {\n  header = lines[0].split(\",\").map(h => h.trim());\n  lines.shift();\n} else {\n  header = [\"timestamp\", \"device\", \"action\", \"detail\", \"duration\", \"etc\"];\n  // ë§Œì•½ ë„¤ íŒŒì¼ í—¤ë”ê°€ ê³ ì •ì´ë¼ë©´ ìœ„ë¥¼ ì‹¤ì œ í—¤ë”ì— ë§žì¶° ìˆ˜ì •\n}\n\nconst rows = [];\nfor (const line of lines) {\n  const cols = line.split(\",\");\n  if (cols.length < 2) continue;\n\n  const obj = {};\n  for (let i = 0; i < Math.min(cols.length, header.length); i++) {\n    obj[header[i]] = cols[i].trim();\n  }\n  rows.push(obj);\n}\n\nmsg.payload = rows.slice(-200);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1840,
        "y": 920,
        "wires": [
            [
                "a3412107226a6d51"
            ]
        ]
    },
    {
        "id": "a3412107226a6d51",
        "type": "ui_table",
        "z": "flow_all",
        "g": "be44b588c52432ea",
        "group": "1b4aaf5eb31383f2",
        "name": "Solution input Table",
        "order": 1,
        "width": 6,
        "height": 10,
        "columns": [],
        "outputs": 1,
        "cts": true,
        "x": 2040,
        "y": 920,
        "wires": [
            []
        ]
    },
    {
        "id": "9f1c418cd3f3a885",
        "type": "ui_template",
        "z": "flow_all",
        "g": "be44b588c52432ea",
        "group": "1b4aaf5eb31383f2",
        "name": "Download CSV Button",
        "order": 3,
        "width": 3,
        "height": 1,
        "format": "<a class=\"md-button md-raised md-primary\" style=\"width:100%;height:100%;display:flex;align-items:center;justify-content:center;\" href=\"/download_solution_dist2\" target=\"_self\">CSV Download</a>",
        "storeOutMessages": false,
        "fwdInMessages": false,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 1270,
        "y": 1060,
        "wires": [
            []
        ]
    },
    {
        "id": "94b0f12f3bc1db62",
        "type": "http in",
        "z": "flow_all",
        "g": "be44b588c52432ea",
        "name": "GET /download_solution_dist2",
        "url": "/download_solution_dist2",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 1290,
        "y": 1120,
        "wires": [
            [
                "7fd7452d9cd017ef"
            ]
        ]
    },
    {
        "id": "7fd7452d9cd017ef",
        "type": "file in",
        "z": "flow_all",
        "g": "be44b588c52432ea",
        "name": "Read CSV (binary)",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_2_Solution_input_log.csv",
        "filenameType": "str",
        "format": "binary",
        "sendError": true,
        "allProps": false,
        "x": 1520,
        "y": 1120,
        "wires": [
            [
                "370b70a08f5dc235"
            ]
        ]
    },
    {
        "id": "370b70a08f5dc235",
        "type": "http response",
        "z": "flow_all",
        "g": "be44b588c52432ea",
        "name": "Send CSV",
        "statusCode": "",
        "headers": {
            "Content-Type": "text/csv; charset=utf-8",
            "Content-Disposition": "attachment; filename=Dist_2_Solution_input_log.csv"
        },
        "x": 1740,
        "y": 1120,
        "wires": []
    },
    {
        "id": "a9ea43292fd0feba",
        "type": "comment",
        "z": "flow_all",
        "g": "be44b588c52432ea",
        "name": "(W)Read Solution A/B/Acid log CSV and show/download",
        "info": "",
        "x": 1430,
        "y": 860,
        "wires": []
    },
    {
        "id": "inj_start_6",
        "type": "inject",
        "z": "tab_mjpg_sched",
        "name": "ë§¤ì¼ 06:00 START",
        "props": [],
        "repeat": "",
        "crontab": "00 06 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 150,
        "y": 220,
        "wires": [
            [
                "exec_start"
            ]
        ]
    },
    {
        "id": "exec_start",
        "type": "exec",
        "z": "tab_mjpg_sched",
        "command": "bash -lc 'cd /home/cja/mjpg-streamer/mjpg-streamer-experimental && export LD_LIBRARY_PATH=. && ./mjpg_streamer -i \"./input_uvc.so -d /dev/video0 -r 1280x720 -f 5\" -o \"./output_http.so -p 8080 -w ./www\" >/tmp/mjpg.log 2>&1 &'",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "start mjpg-streamer",
        "x": 370,
        "y": 220,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "inj_stop_1",
        "type": "inject",
        "z": "tab_mjpg_sched",
        "d": true,
        "name": "ë§¤ì¼ 04:00 STOP",
        "props": [],
        "repeat": "",
        "crontab": "00 04 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 150,
        "y": 120,
        "wires": [
            [
                "exec_stop"
            ]
        ]
    },
    {
        "id": "exec_stop",
        "type": "exec",
        "z": "tab_mjpg_sched",
        "d": true,
        "command": "bash -lc 'pgrep mjpg_streamer >/dev/null && pkill -f mjpg_streamer || true'",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "kill mjpg-streamer",
        "x": 370,
        "y": 120,
        "wires": [
            [],
            [],
            []
        ]
    }
]